{"data":{"markdownRemark":{"html":"<div class=\"content\">\n<h2>Muistiinpano-sovelluksen refaktorointia</h2>\n<p>Jatketaan osan 5 loppupuolella tehdyn muistiinpanosovelluksen yksinkertaistetun <a href=\"/osa5#redux-muistiinpanot\">redux-version</a> laajentamista.</p>\n<p>Sovelluksen tämänhetkinen koodi on <a href=\"https://github.com/FullStack-HY/redux-notes/tree/part5-6\">githubissa</a> tagissa <em>part5-6</em>.</p>\n<p>Tehdään koodiin muutamia rakenteellisia muutoksia. Siirretään reducerin määrittelevä tiedosto <em>noteReducer.js</em> hakemistoon <em>src/reducers</em>.</p>\n<p>Sovelluskehitystä helpottaaksemme laajennetaan reduceria siten, että storelle määritellään alkutila, jossa on pari muistiinpanoa:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    content<span class=\"token punctuation\">:</span> <span class=\"token string\">'reduxin storen toiminnan määrittelee reduceri'</span><span class=\"token punctuation\">,</span>\n    important<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    content<span class=\"token punctuation\">:</span> <span class=\"token string\">'storen tilassa voi olla mielivaltaista dataa'</span><span class=\"token punctuation\">,</span>\n    important<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">noteReducer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> initialState<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> noteReducer<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Siirretään <a href=\"https://redux.js.org/advanced/async-actions#synchronous-action-creators\">action creatorit</a>, eli sopivia <a href=\"https://redux.js.org/basics/actions\">action</a>-olioita generoivat apufunktiot reducerin kanssa samaan moduuliin:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> initialState <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span>\n    content<span class=\"token punctuation\">:</span> <span class=\"token string\">'reduxin storen toiminnan määrittelee reduceri'</span><span class=\"token punctuation\">,</span>\n    important<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span>\n    content<span class=\"token punctuation\">:</span> <span class=\"token string\">'storen tilassa voi olla mielivaltaista dataa'</span><span class=\"token punctuation\">,</span>\n    important<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n    id<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">noteReducer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> initialState<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'NEW_NOTE'</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'TOGGLE_IMPORTANCE'</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">const</span> id <span class=\"token operator\">=</span> action<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">.</span>id<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> noteToChange <span class=\"token operator\">=</span> state<span class=\"token punctuation\">.</span><span class=\"token function\">find</span><span class=\"token punctuation\">(</span>n <span class=\"token operator\">=></span> n<span class=\"token punctuation\">.</span>id <span class=\"token operator\">===</span> id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">const</span> changedNote <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token operator\">...</span>noteToChange<span class=\"token punctuation\">,</span>\n        important<span class=\"token punctuation\">:</span> <span class=\"token operator\">!</span>noteToChange<span class=\"token punctuation\">.</span>important<span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span>note<span class=\"token punctuation\">.</span>id <span class=\"token operator\">!==</span> id <span class=\"token operator\">?</span> note <span class=\"token punctuation\">:</span> changedNote<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">generateId</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">Number</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>Math<span class=\"token punctuation\">.</span><span class=\"token function\">random</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">*</span> <span class=\"token number\">1000000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">toFixed</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">noteCreation</span> <span class=\"token operator\">=</span> content <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    type<span class=\"token punctuation\">:</span> <span class=\"token string\">'NEW_NOTE'</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span>\n      content<span class=\"token punctuation\">,</span>\n      important<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      id<span class=\"token punctuation\">:</span> <span class=\"token function\">generateId</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">importanceToggling</span> <span class=\"token operator\">=</span> id <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    type<span class=\"token punctuation\">:</span> <span class=\"token string\">'TOGGLE_IMPORTANCE'</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">{</span> id <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> noteReducer<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Moduulissa on nyt useita <a href=\"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Statements/export\">export</a>-komentoja.</p>\n<p>Reducer-funktio palautetaan edelleen komennolla <em>export default</em>. Tämän ansiosta reducer importataan (tiedostossa <em>index.js</em>) tuttuun tapaan:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> noteReducer <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers/noteReducer'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Moduulilla voi olla vain <em>yksi default export</em>, mutta useita \"normaaleja\" exporteja, kuten <em>Action creator</em> -funktiot esimerkissämme</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">noteCreation</span> <span class=\"token operator\">=</span> content <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">importanceToggling</span> <span class=\"token operator\">=</span> id <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Normaalisti exportattujen funktioiden käyttöönotto tapahtuu aaltosulkusyntaksilla:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> noteCreation <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./../reducers/noteReducer'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Sovelluksen tämänhetkinen koodi on <a href=\"https://github.com/FullStack-HY/redux-notes/tree/part6-1\">githubissa</a> tagissä <em>part6-1</em>.</p>\n<h2>ESlint</h2>\n<p>Konfiguroimme osassa 3 koodin tyylistä huolehtivan <a href=\"/osa3#lint\">ESlintin</a> backendiin. Otetaan nyt ESlint käyttöön myös frontendissa.</p>\n<p>Create-react-app on asentanut projektille eslintin valmiiksi, joten ei tarvita muuta kun sopiva konfiguraatio tiedoston <em>.eslintrc.js</em>.</p>\n<p>Tiedoston voi generoida komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">npx eslint --init</code></pre></div>\n<p>ja vastailemalla sopivasti kysymyksiin:</p>\n<picture><img src=\"/static/354495f1cf3ab7a581a690e6c465f45f/14be6/1a.png\" srcset=\"/static/354495f1cf3ab7a581a690e6c465f45f/4cce7/1a.png 200w,\n/static/354495f1cf3ab7a581a690e6c465f45f/bae5f/1a.png 400w,\n/static/354495f1cf3ab7a581a690e6c465f45f/14be6/1a.png 800w,\n/static/354495f1cf3ab7a581a690e6c465f45f/11572/1a.png 1116w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Jotta pääsemme eroon testeissä olevista turhista huomautuksista asennetaan <a href=\"https://www.npmjs.com/package/eslint-plugin-jest\">eslint-jest-plugin</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> add --save-dev eslint-plugin-jest</code></pre></div>\n<p>ja otetaan se käyttöön manuaalin opastamalla tavalla.</p>\n<p>Jos vastailit initialisoinnissa kysymyksiin kuvan osoittamalla tavalla, asentuu projektiin <a href=\"https://github.com/yannickcr/eslint-plugin-react\">eslint-plugin-react</a>. Laajennetaan konfiguraatiota pluginin <a href=\"https://github.com/yannickcr/eslint-plugin-react#configuration\">manuaalin</a> ohjeen mukaan.</p>\n<p>Joudumme asentamaan myös <a href=\"https://github.com/babel/babel-eslint\">babel-eslint</a>-pluginin, jotta ESlint osaisi tulkita koodissa käyttämäämme <em>class property</em> -syntaksia. Pluginin asennus tapahtuu komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> babel-eslint --save-dev</code></pre></div>\n<p>ja se tulee muistaa ottaa käyttöön konfiguraatiossa.</p>\n<p>Seuraavassa lopullinen konfiguraatio, mihin on lisätty muutama muukin osassa 3 käyttöönotettu sääntö:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">module.exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"env\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"browser\"</span><span class=\"token keyword\">:</span> true,\n        <span class=\"token string\">\"es6\"</span><span class=\"token keyword\">:</span> true,\n        <span class=\"token string\">\"jest/globals\"</span><span class=\"token keyword\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span>,\n    <span class=\"token string\">\"extends\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"eslint:recommended\"</span>,\n        <span class=\"token string\">\"plugin:react/recommended\"</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"parser\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"babel-eslint\"</span>,\n    <span class=\"token string\">\"parserOptions\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"ecmaFeatures\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"jsx\"</span><span class=\"token keyword\">:</span> <span class=\"token boolean\">true</span>\n        <span class=\"token punctuation\">}</span>,\n        <span class=\"token string\">\"ecmaVersion\"</span><span class=\"token keyword\">:</span> 2018,\n        <span class=\"token string\">\"sourceType\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"module\"</span>\n    <span class=\"token punctuation\">}</span>,\n    <span class=\"token string\">\"plugins\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"react\"</span>, <span class=\"token string\">\"jest\"</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"rules\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"indent\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>,\n            2\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"linebreak-style\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>,\n            <span class=\"token string\">\"unix\"</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"quotes\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>,\n            <span class=\"token string\">\"single\"</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"semi\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>,\n            <span class=\"token string\">\"never\"</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"eqeqeq\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"error\"</span>,\n        <span class=\"token string\">\"no-trailing-spaces\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"error\"</span>,\n        <span class=\"token string\">\"object-curly-spacing\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>, <span class=\"token string\">\"always\"</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"arrow-spacing\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>, <span class=\"token punctuation\">{</span> <span class=\"token string\">\"before\"</span><span class=\"token keyword\">:</span> true, <span class=\"token string\">\"after\"</span><span class=\"token keyword\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"no-console\"</span><span class=\"token keyword\">:</span> 0,\n        <span class=\"token string\">\"react/prop-types\"</span><span class=\"token keyword\">:</span> 0\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>Monimutkaisempi tila storessa</h2>\n<p>Toteutetaan sovellukseen näytettävien muistiinpanojen filtteröinti, jonka avulla näytettäviä muistiinpanoja voidaan rajata. Filtterin toteutus tapahtuu <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTML/Element/input/radio\">radiobuttoneiden</a> avulla:</p>\n<picture><img src=\"/static/e3c779c1ee086430ef1ca18b298a87f1/14be6/1.png\" srcset=\"/static/e3c779c1ee086430ef1ca18b298a87f1/4cce7/1.png 200w,\n/static/e3c779c1ee086430ef1ca18b298a87f1/bae5f/1.png 400w,\n/static/e3c779c1ee086430ef1ca18b298a87f1/14be6/1.png 800w,\n/static/e3c779c1ee086430ef1ca18b298a87f1/1b35a/1.png 1200w,\n/static/e3c779c1ee086430ef1ca18b298a87f1/2c91e/1.png 1548w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Aloitetaan todella suoraviivaisella toteutuksella:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">class App extends React.Component {\n  filterSelected = (value) =&gt; () =&gt; {\n    console.log(value)\n  }\n  render() {\n    return (\n      &lt;div&gt;\n        &lt;NoteForm /&gt;\n        &lt;div&gt;\n          kaikki    &lt;input type=&quot;radio&quot; name=&quot;filter&quot;\n                      onChange={this.filterSelected(&#39;ALL&#39;)}/&gt;\n          tärkeät   &lt;input type=&quot;radio&quot; name=&quot;filter&quot;\n                      onChange={this.filterSelected(&#39;IMPORTANT&#39;)}/&gt;\n          eitärkeät &lt;input type=&quot;radio&quot; name=&quot;filter&quot;\n                      onChange={this.filterSelected(&#39;NONIMPORTANT&#39;)}/&gt;\n        &lt;/div&gt;\n        &lt;NoteList /&gt;\n      &lt;/div&gt;\n    )\n  }\n}</code></pre></div>\n<p>Koska painikkeiden attribuutin <em>name</em> arvo on kaikilla sama, muodostavat ne <em>nappiryhmän</em>, joista ainoastaan yksi voi olla kerrallaan valittuna.</p>\n<p>Napeille on määritelty muutoksenkäsittelijä, joka tällä hetkellä ainoastaan tulostaa painettua nappia vastaavan merkkijonon konsoliin.</p>\n<p>Päätämme toteuttaa filtteröinnin siten, että talletamme muistiinpanojen lisäksi sovelluksen storeen myös <em>filtterin arvon</em>. Eli muutoksen jälkeen storessa olevan tilan tulisi näyttää seuraavalta:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  notes<span class=\"token punctuation\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> content<span class=\"token punctuation\">:</span> <span class=\"token string\">'reduxin storen toiminnan määrittelee reduceri'</span><span class=\"token punctuation\">,</span> important<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span> content<span class=\"token punctuation\">:</span> <span class=\"token string\">'storen tilassa voi olla mielivaltaista dataa'</span><span class=\"token punctuation\">,</span> important<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> id<span class=\"token punctuation\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n  filter<span class=\"token punctuation\">:</span> <span class=\"token string\">'IMPORTANT'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Tällä hetkellähän tilassa on ainoastaan muistiinpanot sisältävä taulukko. Uudessa ratkaisussa tilalla on siis kaksi avainta, <em>notes</em> jonka arvona muistiinpanot ovat sekä <em>filter</em>, jonka arvona on merkkijono joka kertoo mitkä muistiinpanoista tulisi näyttää ruudulla.</p>\n<h3>Yhdistetyt reducerit</h3>\n<p>Voisimme periaatteessa muokata jo olemassaolevaa reduceria ottamaan huomioon muuttuneen tilanteen. Parempi ratkaisu on kuitenkin määritellä tässä tilanteessa uusi, filtterin arvosta huolehtiva reduceri:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> filterReducer <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> <span class=\"token string\">'ALL'</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'SET_FILTER'</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> action<span class=\"token punctuation\">.</span>filter<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">default</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> state<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Filtterin arvon asettavat actionit ovat siis muotoa</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  type<span class=\"token punctuation\">:</span> <span class=\"token string\">'SET_FILTER'</span><span class=\"token punctuation\">,</span>\n  filter<span class=\"token punctuation\">:</span> <span class=\"token string\">'IMPORTANT'</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Määritellään samalla myös sopiva <em>action creator</em> -funktio. Sijoitetaan koodi moduuliin <em>src/reducers/filterReducer.js</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> filterReducer <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> <span class=\"token string\">'ALL'</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">filterChange</span> <span class=\"token operator\">=</span> filter <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    type<span class=\"token punctuation\">:</span> <span class=\"token string\">'SET_FILTER'</span><span class=\"token punctuation\">,</span>\n    filter<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> filterReducer<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Saamme nyt muodostettua varsinaisen reducerin yhdistämällä kaksi olemassaolevaa reduceria funktion <a href=\"https://redux.js.org/api-reference/combinereducers\">combineReducers</a> avulla.</p>\n<p>Määritellään yhdistetty reduceri tiedostossa <em>index.js</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport ReactDOM from &#39;react-dom&#39;\nimport { createStore, combineReducers } from &#39;redux&#39;\nimport { Provider } from &#39;react-redux&#39;\nimport App from &#39;./App&#39;\nimport noteReducer from &#39;./reducers/noteReducer&#39;\nimport filterReducer from &#39;./reducers/filterReducer&#39;\n\nconst reducer = combineReducers({\n  notes: noteReducer,\n  filter: filterReducer\n})\n\nconst store = createStore(reducer)\n\nconsole.log(store.getState())\n\nReactDOM.render(\n  &lt;Provider store={store}&gt;\n    &lt;div&gt; &lt;/div&gt;\n  &lt;/Provider&gt;,\ndocument.getElementById(&#39;root&#39;))</code></pre></div>\n<p>Koska sovelluksemme hajoaa tässä vaiheessa täysin, komponentin <em>App</em> sijasta renderöidään tyhjä <em>div</em>-elementti.</p>\n<p>Konsoliin tulostuu storen tila:</p>\n<picture><img src=\"/static/5051fd826fdf82f90e9326b9b2e82875/14be6/2.png\" srcset=\"/static/5051fd826fdf82f90e9326b9b2e82875/4cce7/2.png 200w,\n/static/5051fd826fdf82f90e9326b9b2e82875/bae5f/2.png 400w,\n/static/5051fd826fdf82f90e9326b9b2e82875/14be6/2.png 800w,\n/static/5051fd826fdf82f90e9326b9b2e82875/1b35a/2.png 1200w,\n/static/5051fd826fdf82f90e9326b9b2e82875/9ee03/2.png 1600w,\n/static/5051fd826fdf82f90e9326b9b2e82875/4f68a/2.png 1874w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>eli store on juuri siinä muodossa missä haluammekin sen olevan!</p>\n<p>Tarkastellaan vielä yhdistetyn reducerin luomista</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> reducer <span class=\"token operator\">=</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  notes<span class=\"token punctuation\">:</span> noteReducer<span class=\"token punctuation\">,</span>\n  filter<span class=\"token punctuation\">:</span> filterReducer<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Näin tehdyn reducerin määrittelemän storen tila on olio, jossa on kaksi kenttää, <em>notes</em> ja <em>filter</em>. Tilan kentän <em>notes</em> arvon määrittelee <em>noteReducer</em>, jonka ei tarvitse välittää mitään tilan muista kentistä. Vastaavasti <em>filter</em> kentän käsittely tapahtuu <em>filterReducer</em>:in avulla.</p>\n<p>Ennen muun koodin muutoksia, kokeillaan vielä konsolista, miten actionit muuttavat yhdistetyn reducerin muodostamaa staten tilaa:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">//...</span>\n<span class=\"token keyword\">import</span> noteReducer<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> noteCreation <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers/noteReducer'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> filterReducer<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> filterChange <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers/filterReducer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> reducer <span class=\"token operator\">=</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  notes<span class=\"token punctuation\">:</span> noteReducer<span class=\"token punctuation\">,</span>\n  filter<span class=\"token punctuation\">:</span> filterReducer<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>reducer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nstore<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nconsole<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nstore<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">filterChange</span><span class=\"token punctuation\">(</span><span class=\"token string\">'IMPORTANT'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\nstore<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">noteCreation</span><span class=\"token punctuation\">(</span><span class=\"token string\">'combineReducers muodostaa yhdistetyn reducerin'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Konsoliin tulostuu storen tila:</p>\n<picture><img src=\"/static/83a1b076646fee2dc3280855e651286c/14be6/3.png\" srcset=\"/static/83a1b076646fee2dc3280855e651286c/4cce7/3.png 200w,\n/static/83a1b076646fee2dc3280855e651286c/bae5f/3.png 400w,\n/static/83a1b076646fee2dc3280855e651286c/14be6/3.png 800w,\n/static/83a1b076646fee2dc3280855e651286c/1b35a/3.png 1200w,\n/static/83a1b076646fee2dc3280855e651286c/9ee03/3.png 1600w,\n/static/83a1b076646fee2dc3280855e651286c/a5108/3.png 1726w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Jo tässä vaiheessa kannattaa laittaa mieleen eräs tärkeä detalji. Jos lisäämme <em>molempien reducerien alkuun</em> konsoliin tulostuksen:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> filterReducer <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> <span class=\"token string\">'ALL'</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ACTION: '</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Näyttää konsolin perusteella siltä, että jokainen action kahdentuu:</p>\n<picture><img src=\"/static/430abd5399e0ac8080e0d93a83683c41/14be6/4.png\" srcset=\"/static/430abd5399e0ac8080e0d93a83683c41/4cce7/4.png 200w,\n/static/430abd5399e0ac8080e0d93a83683c41/bae5f/4.png 400w,\n/static/430abd5399e0ac8080e0d93a83683c41/14be6/4.png 800w,\n/static/430abd5399e0ac8080e0d93a83683c41/1b35a/4.png 1200w,\n/static/430abd5399e0ac8080e0d93a83683c41/248be/4.png 1578w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Onko koodissa bugi? Ei. Yhdistetty reducer toimii siten, että jokainen <em>action</em> käsitellään <em>kaikissa</em> yhdistetyn reducerin osissa. Usein tietystä actionista on kiinnostunut vain yksi reduceri, on kuitenkin tilanteita, joissa useampi reduceri muuttaa hallitsemaansa staten tilaa jonkin actionin seurauksena.</p>\n<h3>Sovelluksen viimeistely</h3>\n<p>Viimeistellään nyt sovellus käyttämään yhdistettyä reduceria, eli palautetaan tiedostossa <em>index.js</em> suoritettava renderöinti muotoon</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">ReactDOM.render(\n  &lt;Provider store={store}&gt;\n    &lt;App /&gt;\n  &lt;/Provider&gt;,\n  document.getElementById(&#39;root&#39;))</code></pre></div>\n<p>Korjataan sitten bugi, joka johtuu siitä, että koodi olettaa storen tilan olevan mustiinpanot tallettava taulukko:</p>\n<picture><img src=\"/static/bdf7db7bc2a52ec058453dd1bf264eff/14be6/5.png\" srcset=\"/static/bdf7db7bc2a52ec058453dd1bf264eff/4cce7/5.png 200w,\n/static/bdf7db7bc2a52ec058453dd1bf264eff/bae5f/5.png 400w,\n/static/bdf7db7bc2a52ec058453dd1bf264eff/14be6/5.png 800w,\n/static/bdf7db7bc2a52ec058453dd1bf264eff/1b35a/5.png 1200w,\n/static/bdf7db7bc2a52ec058453dd1bf264eff/9ee03/5.png 1600w,\n/static/bdf7db7bc2a52ec058453dd1bf264eff/4ba44/5.png 1660w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Korjaus on helppo. Viitteen <code>this.context.store.getState()</code> sijaan kaikki muistiinpanot sisältävään taulukkoon viitataan <code>this.context.store.getState().notes</code>.</p>\n<p>Ennakoiden tulevaa eriytetään näytettävien muistiinpanojen selvittämisen huolehtiminen funktioon <em>notesToShow</em>, joka vielä tässä vaiheessa palauttaa kaikki muistiinpanot:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">class NoteList extends React.Component {\n  // ...\n\n  render() {\n    const notesToShow = () =&gt; {\n      return this.context.store.getState().notes\n    }\n\n    return (\n      &lt;ul&gt;\n        {notesToShow().map(note =&gt;\n          &lt;Note\n            key={note.id}\n            note={note}\n            handleClick={this.toggleImportance(note.id)}\n          /&gt;\n        )}\n      &lt;/ul&gt;\n    )\n  }\n}</code></pre></div>\n<p>Eriytetään näkyvyyden säätelyfiltteri omaksi, tiedostoon sijoitettavaksi <em>src/components/VisibilityFilter.js</em> komponentiksi:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport PropTypes from &#39;prop-types&#39;\nimport { filterChange } from &#39;../reducers/filterReducer&#39;\n\nclass VisibilityFilter extends React.Component {\n  componentDidMount() {\n    const { store } = this.context\n    this.unsubscribe = store.subscribe(() =&gt;\n      this.forceUpdate()\n    )\n  }\n\n  componentWillUnmount() {\n    this.unsubscribe()\n  }\n\n  filterClicked = (value) =&gt; () =&gt; {\n    this.context.store.dispatch(filterChange(value))\n  }\n\n  render() {\n    return (\n      &lt;div&gt;\n        kaikki    &lt;input type=&quot;radio&quot; name=&quot;filter&quot; onChange={this.filterClicked(&#39;ALL&#39;)} /&gt;\n        tärkeät   &lt;input type=&quot;radio&quot; name=&quot;filter&quot; onChange={this.filterClicked(&#39;IMPORTANT&#39;)} /&gt;\n        eitärkeät &lt;input type=&quot;radio&quot; name=&quot;filter&quot; onChange={this.filterClicked(&#39;NONIMPORTANT&#39;)} /&gt;\n      &lt;/div&gt;\n    )\n  }\n}\n\nVisibilityFilter.contextTypes = {\n  store: PropTypes.object\n}\n\nexport default VisibilityFilter</code></pre></div>\n<p>Toteutus on suoraviivainen, radiobuttonin klikkaaminen muuttaa storen kentän <em>filter</em> tilaa.</p>\n<p>Muutetaan vielä komponentin <em>NoteList</em> metodi <em>notesToShow</em> ottamaan huomioon filtteri</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">notesToShow</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> notes<span class=\"token punctuation\">,</span> filter <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>filter <span class=\"token operator\">===</span> <span class=\"token string\">'ALL'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> notes<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> filter <span class=\"token operator\">===</span> <span class=\"token string\">'IMPORTANT'</span>\n    <span class=\"token operator\">?</span> notes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> note<span class=\"token punctuation\">.</span>important<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">:</span> notes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>note<span class=\"token punctuation\">.</span>important<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Huomaa miten storen tilan kentät on otettu tuttuun tapaan destrukturoimalla apumuuttujiin</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> notes<span class=\"token punctuation\">,</span> filter <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>siis on sama kuin kirjoittaisimme</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> notes <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">const</span> filter <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">getState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>filter<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Sovelluksen tämänhetkinen koodi on <a href=\"https://github.com/FullStack-HY/redux-notes/tree/part6-2\">githubissa</a> tagissä <em>part6-2</em>.</p>\n<p>Sovelluksessa on vielä pieni kauneusvirhe, vaikka oletusarvosesti filtterin arvo on <em>ALL</em>, eli näytetään kaikki muistiinpanot, ei vastaava radiobutton ole valittuna. Ongelma on luonnollisestikin mahdollista korjata, mutta koska kyseessä on ikävä, mutta harmiton feature, jätämme korjauksen myöhemmäksi.</p>\n<h2>Tehtäviä</h2>\n<p>Tee nyt tehtävät <a href=\"/teht%C3%A4v%C3%A4t/#osa-6\">6.1-6.5</a></p>\n<h2>Connect</h2>\n<p>Kaikissa Redux-storea käyttävissä komponenteissa on runsaasti samaa koodia</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">ComponentUsingReduxStore</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> store <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>unsubscribe <span class=\"token operator\">=</span> store<span class=\"token punctuation\">.</span><span class=\"token function\">subscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">forceUpdate</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">componentWillUnmount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">unsubscribe</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\nComponentUsingReduxStore<span class=\"token punctuation\">.</span>contextTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  store<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>object<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Vaikka rivit on helppo copy-pasteta aina uusiin komponentteihin, ei tämä ole tarkoituksenmukaista. Osan 5 luvussa <a href=\"/osa5#staten-v%C3%A4litt%C3%A4minen-propseissa-ja-contextissa\">staten välittäminen propseissa ja contextissa</a> myös varoiteltiin luottamasta liikaa Reactin Context API:iin, se on kokeellinen ja saattaa poistua tulevissa versioissa. Contextia on siis ainakin tässä vaiheessa käytettävä varovasti.</p>\n<p><a href=\"https://github.com/reactjs/react-redux\">React Redux</a> -kirjaston määrittelemä funktio <a href=\"https://github.com/reactjs/react-redux/blob/master/docs/api.md#connectmapstatetoprops-mapdispatchtoprops-mergeprops-options\">connect</a> on paras ratkaisu siihen, miten Redux-store saadaan välitettyä React-componenteille.</p>\n<p>Connect voi olla aluksi haastava sisäistää, mutta hieman vaivaa kannattaa ehdottomasti nähdä. Tutustutaan nyt connectin käyttöön. Asensimme jo edellisessä osassa kirjaston, joten voimme aloittaa sen käytön suoraan.</p>\n<p>Tutkitaan ensin komponenttia <em>NoteList</em>. Funktiota <em>connect</em> käyttämällä \"normaaleista\" React-komponenteista saadaan muodostettua komponentteja, joiden <em>propseihin</em> on \"mäpätty\" eli yhdistetty haluttuja osia storen määrittelemästä tilasta.</p>\n<p>Muodostetaan ensin komponentista <em>NoteList</em> connectin avulla <em>yhdistetty komponentti</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> connect <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-redux'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">NoteList</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> ConnectedNoteList <span class=\"token operator\">=</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>NoteList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> ConnectedNoteList<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Moduuli eksporttaa nyt alkuperäisen komponentin sijaan <em>yhdistetyn komponentin</em>, joka toimii toistaiseksi täsmälleen alkuperäisen komponentin kaltaisesti.</p>\n<p>Komponentti tarvitsee storesta sekä muistiinpanojen listan, että filtterin arvon. Funktion <em>connect</em> ensimmäisenä parametrina voidaan määritellä funktio <a href=\"https://github.com/reactjs/react-redux/blob/master/docs/api.md#arguments\">mapStateToProps</a>, joka liittää joitakin storen tilan perusteella määriteltyjä asioita connectilla muodostetun <em>yhdistetyn komponentin</em> propseiksi.</p>\n<p>Jos määritellään:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mapStateToProps</span> <span class=\"token operator\">=</span> state <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    notes<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">,</span>\n    filter<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>filter<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> ConnectedNoteList <span class=\"token operator\">=</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>mapStateToProps<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>NoteList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> ConnectedNoteList<span class=\"token punctuation\">;</span></code></pre></div>\n<p>on komponentin <em>NoteList</em> sisällä mahdollista viitata storen tilaan, esim. muistiinpanoihin suoraan propsin kautta <em>props.notes</em> sen sijaan, että käytettäisiin suoraan contextia muodossa <em>this.context.store.getState().notes</em>. Vastaavasti <em>props.filter</em> viittaa storessa olevaan filter-kentän tilaan.</p>\n<p>Metodin <em>render</em> sisältö pelkistyy seuraavasti</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">NoteList</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">notesToShow</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> notes<span class=\"token punctuation\">,</span> filter <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n      <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>filter <span class=\"token operator\">===</span> <span class=\"token string\">'ALL'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token keyword\">return</span> notes<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span>\n\n      <span class=\"token keyword\">return</span> filter <span class=\"token operator\">===</span> <span class=\"token string\">'IMPORTANT'</span>\n        <span class=\"token operator\">?</span> notes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> note<span class=\"token punctuation\">.</span>important<span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">:</span> notes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>note<span class=\"token punctuation\">.</span>important<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Connect-komennolla, ja <em>mapStateToProps</em>-määrittelyllä aikaan saatua tilannetta voidaan visualisoida seuraavasti:</p>\n<picture><img src=\"/static/9b0db201aaba8e035a782f2f07364ab2/14be6/5b.png\" srcset=\"/static/9b0db201aaba8e035a782f2f07364ab2/4cce7/5b.png 200w,\n/static/9b0db201aaba8e035a782f2f07364ab2/bae5f/5b.png 400w,\n/static/9b0db201aaba8e035a782f2f07364ab2/14be6/5b.png 800w,\n/static/9b0db201aaba8e035a782f2f07364ab2/1b35a/5b.png 1200w,\n/static/9b0db201aaba8e035a782f2f07364ab2/2e309/5b.png 1382w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>eli komponentin <em>NoteList</em> sisältä on propsien <em>props.notes</em> ja <em>props.filter</em> kautta \"suora pääsy\" tarkastelemaan Redux storen sisällä olevaa tilaa.</p>\n<p><em>NoteList</em> viittaa edelleen suoraan kontekstin kautta storen metodiin <em>dispatch</em>, jota se tarvitsee action creatorin <em>importanceToggling</em> avulla tehdyn actionin dispatchaamiseen:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">toggleImportance</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>context<span class=\"token punctuation\">.</span>store<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span>\n    <span class=\"token function\">importanceToggling</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">)</span></code></pre></div>\n<p>Connect-funktion toisena parametrina voidaan määritellä <a href=\"https://github.com/reactjs/react-redux/blob/master/docs/api.md#arguments\">mapDispatchToProps</a> eli joukko <em>action creator</em> -funktioita, jotka välitetään yhdistetylle komponentille propseina. Laajennetaan connectausta seuraavasti</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mapStateToProps</span> <span class=\"token operator\">=</span> state <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    notes<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">,</span>\n    filter<span class=\"token punctuation\">:</span> state<span class=\"token punctuation\">.</span>filter<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> mapDispatchToProps <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  importanceToggling<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> ConnectedNoteList <span class=\"token operator\">=</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n  mapStateToProps<span class=\"token punctuation\">,</span>\n  mapDispatchToProps\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>NoteList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> ConnectedNoteList<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Nyt komponentti voi dispatchata suoraan action creatorin <em>importanceToggling</em> määrittelemän actionin kutsumalla propsien kautta saamaansa funktiota koodissa:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">NoteList</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">toggleImportance</span> <span class=\"token operator\">=</span> id <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">importanceToggling</span><span class=\"token punctuation\">(</span>id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Storen <em>dispatch</em>-funktiota ei enää tarvitse kutsua, sillä <em>connect</em> on muokannut action creatorin <em>importanceToggling</em> sellaiseen muotoon, joka sisältää dispatchauksen.</p>\n<p><em>mapDispatchToProps</em> lienee aluksi hieman haastava ymmärtää, etenkin sen kohta käsiteltävä <a href=\"/osa6/#mapdispatchtopropsin-vaihtoehtoinen-k%C3%A4ytt%C3%B6tapa\">vaihtoehtoinen käyttötapa</a>.</p>\n<p>Connectin aikaansaamaa tilannetta voidaan havainnollistaa seuraavasti:</p>\n<picture><img src=\"/static/f41667cdd6a8f0dfb230ba0207d60a20/14be6/5c.png\" srcset=\"/static/f41667cdd6a8f0dfb230ba0207d60a20/4cce7/5c.png 200w,\n/static/f41667cdd6a8f0dfb230ba0207d60a20/bae5f/5c.png 400w,\n/static/f41667cdd6a8f0dfb230ba0207d60a20/14be6/5c.png 800w,\n/static/f41667cdd6a8f0dfb230ba0207d60a20/1b35a/5c.png 1200w,\n/static/f41667cdd6a8f0dfb230ba0207d60a20/78a53/5c.png 1564w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>eli sen lisäksi että <em>NoteList</em> pääsee storen tilaan propsien <em>props.notes</em> ja <em>props.filter</em> kautta, se viittaa <em>props.importanceToggling</em>:lla funktioon, jonka avulla storeen saadaan dispatchattua <em>TOGGLE</em>IMPORTANCE_-tyyppisiä actioneja.</p>\n<p>Koska komponentti saa storeen liittyvät asiat propseina, voidaan koodista poistaa metodit <em>componentDidMount</em> ja <em>componentWillUnMount</em> jotka huolehtivat komponentin uudelleenrenderöitymisestä storen tilan muuttuessa. Connect tekee tämän puolestamme.</p>\n<p>Komponentti <em>NoteList</em> ei tarvitse storea enää mihinkään, se saa kaiken tarvitsemansa propseina <em>connect</em>-funktion ansiosta. Komponentti ei käytä enää suoraan contextia, joten koodi yksinkertaistuu seuraavaan muotoon:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport { connect } from &#39;react-redux&#39;\nimport { importanceToggling } from &#39;./../reducers/noteReducer&#39;\nimport Note from &#39;./Note&#39;\n\nclass NoteList extends React.Component {\n  render() {\n    const notesToShow = () =&gt; {\n      const { notes, filter } = this.props\n      if (filter === &#39;ALL&#39;) {\n        return notes\n      }\n\n      return filter === &#39;IMPORTANT&#39;\n        ? notes.filter(note =&gt; note.important)\n        : notes.filter(note =&gt; !note.important)\n    }\n\n    return (\n      &lt;ul&gt;\n        {notesToShow().map(note =&gt;\n          &lt;Note\n            key={note.id}\n            note={note}\n            handleClick={() =&gt; this.props.importanceToggling(note.id)}\n          /&gt;\n        )}\n      &lt;/ul&gt;\n    )\n  }\n}\n\nconst mapStateToProps = (state) =&gt; {\n  return {\n    notes: state.notes,\n    filter: state.filter\n  }\n}\n\nconst ConnectedNoteList = connect(\n  mapStateToProps,\n  { importanceToggling }\n)(NoteList)\n\nexport default ConnectedNoteList</code></pre></div>\n<p>Koodi sisältää pari muutakin oikaisua, mm. apumetodista <em>toggleImportance</em> on hankkiuduttu eroon.\nItseasiassa komponentti on nyt niin yksinkertainen että se voitaisiin määritellä funktionaalisena komponenttina. Emme kuitenkaan tee muutosta nyt.</p>\n<p>Otetaan <em>connect</em> käyttöön myös uuden muistiinpanon luomisessa:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport { noteCreation } from &#39;./../reducers/noteReducer&#39;\nimport { connect } from &#39;react-redux&#39;\n\nclass NoteForm extends React.Component {\n\n  addNote = (event) =&gt; {\n    event.preventDefault()\n    this.props.noteCreation(event.target.note.value)\n    event.target.note.value = &#39;&#39;\n  }\n\n  render() {\n    return (\n      &lt;form onSubmit={this.addNote}&gt;\n        &lt;input name=&quot;note&quot; /&gt;\n        &lt;button&gt;lisää&lt;/button&gt;\n      &lt;/form&gt;\n    )\n  }\n}\n\nexport default connect(\n  null,\n  { noteCreation }\n)(NoteForm)</code></pre></div>\n<p>Koska komponentti ei tarvitse storen tilasta mitään, on funktion <em>connect</em> ensimmäinen parametri <em>null</em>.</p>\n<p>Sovelluksen tämänhetkinen koodi on <a href=\"https://github.com/FullStack-HY/redux-notes/tree/part6-3\">githubissa</a> tagissä <em>part6-3</em>.</p>\n<h3>Provider</h3>\n<p>Funktion <em>connect</em> käytön edellytyksenä on se, että sovellus on määritelty React redux kirjaston tarjoaman <a href=\"https://github.com/reactjs/react-redux/blob/master/docs/api.md#provider-store\">Provider</a>-komponentin lapseksi ja että sovelluksen käyttämä store on annettu Provider-komponentin attribuutiksi <em>store</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport ReactDOM from &#39;react-dom&#39;\nimport { createStore, combineReducers } from &#39;redux&#39;\nimport { Provider } from &#39;react-redux&#39;\nimport App from &#39;./App&#39;\nimport noteReducer from &#39;./reducers/noteReducer&#39;\nimport filterReducer from &#39;./reducers/filterReducer&#39;\n\nconst reducer = combineReducers({\n  notes: noteReducer,\n  filter: filterReducer\n})\n\nconst store = createStore(reducer)\n\nReactDOM.render(\n  &lt;Provider store={store}&gt;\n    &lt;App /&gt;\n  &lt;/Provider&gt;,\n  document.getElementById(&#39;root&#39;))</code></pre></div>\n<p>Lisäsimme jo edellisen osan lopussa sovellukseen <em>Providerin</em>, joten <em>connect</em> oli tällä kertaa suoraan käytettävissä.</p>\n<h3>Huomio propsina välitettyyn action creatoriin viittaamisesta</h3>\n<p>Tarkastellaan vielä erästä mielenkiintoista seikkaa komponentista <em>NoteForm</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport { noteCreation } from &#39;./../reducers/noteReducer&#39;\nimport { connect } from &#39;react-redux&#39;\n\nclass NoteForm extends React.Component {\n\n  addNote = (event) =&gt; {\n    event.preventDefault()\n    this.props.noteCreation(event.target.note.value)\n    event.target.note.value = &#39;&#39;\n  }\n\n  render() {\n    // ...\n  }\n}\n\nexport default connect(\n  null,\n  { noteCreation }\n)(NoteForm)</code></pre></div>\n<p>Aloittelevalle connectin käyttäjälle aiheuttaa joskus ihmetystä se, että action creatorista <em>noteCreation</em> on komponentin sisällä käytettävissä <em>kaksi eri versiota</em>.</p>\n<p>Funktioon tulee viitata propsien kautta, eli <em>this.props.noteCreation</em>, tällöin kyseessä on <em>connectin</em> muotoilema, <em>dispatchauksen sisältävä</em> versio funktiosta.</p>\n<p>Moduulissa olevan import-lauseen</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> noteCreation <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./../reducers/noteReducer'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ansiosta komponentin sisältä on mahdollista viitata funktioon myös suoraan, eli <em>noteCreation</em>. Näin ei kuitenkaan tule tehdä, sillä silloin on kyseessä alkuperäinen action creator joka <em>ei sisällä dispatchausta</em>.</p>\n<p>Jos tulostamme funktiot koodin sisällä (emme olekaan vielä käyttäneet kurssilla tätä erittäin hyödyllistä debug-kikkaa)</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">render() {\n  console.log(noteCreation)\n  console.log(this.props.noteCreation)\n  return (\n    &lt;form onSubmit={this.addNote}&gt;\n      &lt;input name=&quot;note&quot; /&gt;\n      &lt;button&gt;lisää&lt;/button&gt;\n    &lt;/form&gt;\n  )\n}</code></pre></div>\n<p>näemme eron:</p>\n<picture><img src=\"/static/eb383dd9fbafd64a8231aae424434fee/14be6/5d.png\" srcset=\"/static/eb383dd9fbafd64a8231aae424434fee/4cce7/5d.png 200w,\n/static/eb383dd9fbafd64a8231aae424434fee/bae5f/5d.png 400w,\n/static/eb383dd9fbafd64a8231aae424434fee/14be6/5d.png 800w,\n/static/eb383dd9fbafd64a8231aae424434fee/1b35a/5d.png 1200w,\n/static/eb383dd9fbafd64a8231aae424434fee/92884/5d.png 1378w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Ensimmäinen funktioista siis on normaali <em>action creator</em>, toinen taas connectin muotoilema funktio, joka sisältää storen metodin dispatch-kutsun.</p>\n<p>Connect on erittäin kätevä työkalu, mutta abstraktiutensa takia kenties käsitteellisesti haastavin kurssin tähänastisista asioista.</p>\n<p>Viimeistään nyt kannattaa katsoa kokonaisuudessaan Egghead.io:ta Reduxin kehittäjän Dan Abramovin loistava tuoriaali <a href=\"https://egghead.io/courses/getting-started-with-redux\">Getting started with Redux</a>. Neljässä viimeisessä videossa käsitellään <em>connect</em>-metodia.</p>\n<p>Siinä vaiheessa kun videot on tehty, connectin käyttö oli asteen verran nykyistä hankalampaa, sillä esimerkeissä käyttämämme tapa määritellä connectin toinen parametri <em>mapDispatchToProps</em> suoraan <em>action creator</em> -funktioiden avulla ei ollut vielä mahdollinen. Katsotaan seuraavassa luvussa lyhyesti vaihtoehtoista, \"hankalampaa\" tapaa, sitä näkee usein vanhemmassa React-koodissa, joten sen tunteminen on oleellista.</p>\n<h3>mapDispatchToPropsin vaihtoehtoinen käyttötapa</h3>\n<p>Määrittelimme siis connectin komponentille <em>NoteForm</em> antamat actioneja dispatchaavan funktion seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">NoteForm</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n  <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> noteCreation <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>NoteForm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Eli määrittelyn ansiosta komponentti dispatchaa uuden muistiinpanon lisäyksen suorittavan actionin suoraan komennolla <code>this.props.noteCreation('uusi muistiinpano')</code>.</p>\n<p>Parametrin <em>mapDispatchToProps</em> kenttinä ei voi antaa mitä tahansa funktiota, vaan funktion on oltava <em>action creator</em>, eli Redux-actionin palauttava funktio.</p>\n<p>Kannattaa huomata, että parametri <em>mapDispatchToProps</em> on nyt <em>olio</em>, sillä määrittely</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  noteCreation<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>on lyhempi tapa määritellä olioliteraali</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span>\n  noteCreation<span class=\"token punctuation\">:</span> noteCreation<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>eli olio, jonka ainoan kentän <em>noteCreation</em> arvona on funktio <em>noteCreation</em>.</p>\n<p>Voimme määritellä saman myös \"pitemmän kaavan\" kautta, antamalla <em>connectin</em> toisena parametrina seuraavanlaisen <em>funktion</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">NoteForm</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mapDispatchToProps</span> <span class=\"token operator\">=</span> dispatch <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    createTodo<span class=\"token punctuation\">:</span> value <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n      <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">noteCreation</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n  <span class=\"token keyword\">null</span><span class=\"token punctuation\">,</span>\n  mapDispatchToProps\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>NoteForm<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Tässä vaihtoehtoisessa tavassa <em>mapDispatchToProps</em> on funktio, jota <em>connect</em> kutsuu antaen sille parametriksi storen <em>dispatch</em>-funktion. Funktion paluuarvona on olio, joka määrittelee joukon funktioita, jotka annetaan connectoitavalle komponentille propsiksi. Esimerkkimme määrittelee propsin <em>createTodo</em> olevan funktion</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">value <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">noteCreation</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>eli action creatorilla luodun actionin dispatchaus.</p>\n<p>Komponentti siis viittaa funktioon propsin <em>this.props.createTodo</em> kautta:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">class NoteForm extends React.Component {\n\n  addNote = (event) =&gt; {\n    event.preventDefault()\n    this.props.createTodo(event.target.note.value)\n    event.target.note.value = &#39;&#39;\n  }\n\n  render() {\n    return (\n      &lt;form onSubmit={this.addNote}&gt;\n        &lt;input name=&quot;note&quot; /&gt;\n        &lt;button&gt;lisää&lt;/button&gt;\n      &lt;/form&gt;\n    )\n  }\n}</code></pre></div>\n<p>Konsepti on hiukan monimutkainen ja sen selittäminen sanallisesti on haastavaa. Kannattaa katsoa huolellisesti Dan Abramovin videot ja koittaa miettiä mistä on kyse.</p>\n<p>Useimmissa tapauksissa riittää <em>mapDispatchToProps</em>:in yksinkertaisempi muoto. On kuitenkin tilanteita, joissa monimutkaisempi muoto on tarpeen, esim. jos määriteltäessä propseiksi mäpättyjä <em>dispatchattavia actioneja</em> on <a href=\"https://github.com/gaearon/redux-devtools/issues/250#issuecomment-186429931\">viitattava komponentin omiin propseihin</a>.</p>\n<h2>Presentational/Container revisited</h2>\n<p>Komponentti <em>NoteList</em> käyttää apumetodia <em>notesToShow</em>, joka päättelee filtterin perusteella näytettävien muistiinpanojen listan:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">notesToShow</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> notes<span class=\"token punctuation\">,</span> filter <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>filter <span class=\"token operator\">===</span> <span class=\"token string\">'ALL'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> notes<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> filter <span class=\"token operator\">===</span> <span class=\"token string\">'IMPORTANT'</span>\n    <span class=\"token operator\">?</span> notes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> note<span class=\"token punctuation\">.</span>important<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">:</span> notes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>note<span class=\"token punctuation\">.</span>important<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Komponentin on tarpeetonta sisältää kaikkea tätä logiikkaa. Eriytetään se komponentin ulkopuolelle <em>connect</em>-metodin parametrin <em>mapStateToProps</em> yhteyteen. Muutetaan komponentti samalla funktionaaliseksi:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport { connect } from &#39;react-redux&#39;\nimport { importanceToggling } from &#39;./../reducers/noteReducer&#39;\nimport Note from &#39;./Note&#39;\n\nconst NoteList = (props) =&gt; (\n  &lt;ul&gt;\n    {props.visibleNotes.map(note =&gt;\n      &lt;Note\n        key={note.id}\n        note={note}\n        handleClick={() =&gt; props.importanceToggling(note.id)}\n      /&gt;\n    )}\n  &lt;/ul&gt;\n)\n\nconst notesToShow = (notes, filter) =&gt; {\n  if (filter === &#39;ALL&#39;) {\n    return notes\n  }\n  return filter === &#39;IMPORTANT&#39;\n    ? notes.filter(note =&gt; note.important)\n    : notes.filter(note =&gt; !note.important)\n}\n\nconst mapStateToProps = (state) =&gt; {\n  return {\n    visibleNotes: notesToShow(state.notes, state.filter)\n  }\n}\n\nexport default connect(\n  mapStateToProps,\n  { importanceToggling }\n)(NoteList)</code></pre></div>\n<p><em>mapStateToProps</em> ei siis tällä kertaa mäppää propsiksi suoraan storessa olevaa asiaa, vaan storen tilasta funktion <em>notesToShow</em> avulla muodostetun sopivasti filtteröidyn datan.</p>\n<p>Uudistettu <em>NoteList</em> keskittyy lähes ainoastaan muistiinpanojen renderöimiseen, se on hyvin lähellä sitä minkä sanotaan olevan <a href=\"https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0\">presentational</a>-komponentti, joita Dan Abramovin <a href=\"https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0\">sanoin</a> kuvailee seuraavasti:</p>\n<ul>\n<li>Are concerned with how things look.</li>\n<li>May contain both presentational and container components inside, and usually have some DOM markup and styles of their own.</li>\n<li>Often allow containment via this.props.children.</li>\n<li>Have no dependencies on the rest of the app, such Redux actions or stores.</li>\n<li>Don’t specify how the data is loaded or mutated.</li>\n<li>Receive data and callbacks exclusively via props.</li>\n<li>Rarely have their own state (when they do, it’s UI state rather than data).</li>\n<li>Are written as functional components unless they need state, lifecycle hooks, or performance optimizations.</li>\n</ul>\n<p>Connect-metodin avulla muodostettu <em>yhdistetty komponentti</em></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">notesToShow</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>notes<span class=\"token punctuation\">,</span> filter<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>filter <span class=\"token operator\">===</span> <span class=\"token string\">'ALL'</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> notes<span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> filter <span class=\"token operator\">===</span> <span class=\"token string\">'IMPORTANT'</span>\n    <span class=\"token operator\">?</span> notes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> note<span class=\"token punctuation\">.</span>important<span class=\"token punctuation\">)</span>\n    <span class=\"token punctuation\">:</span> notes<span class=\"token punctuation\">.</span><span class=\"token function\">filter</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>note<span class=\"token punctuation\">.</span>important<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">mapStateToProps</span> <span class=\"token operator\">=</span> state <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    visibleNotes<span class=\"token punctuation\">:</span> <span class=\"token function\">notesToShow</span><span class=\"token punctuation\">(</span>state<span class=\"token punctuation\">.</span>notes<span class=\"token punctuation\">,</span> state<span class=\"token punctuation\">.</span>filter<span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token function\">connect</span><span class=\"token punctuation\">(</span>\n  mapStateToProps<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">{</span> importanceToggling <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">(</span>NoteList<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>taas on selkeästi <em>container</em>-komponentti, joita Dan Abramov <a href=\"https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0\">luonnehtii</a> seuraavasti:</p>\n<ul>\n<li>Are concerned with how things work.</li>\n<li>May contain both presentational and container components inside but usually don’t have any DOM markup of their own except for some wrapping divs, and never have any styles.</li>\n<li>Provide the data and behavior to presentational or other container components.</li>\n<li>Call Redux actions and provide these as callbacks to the presentational components.</li>\n<li>Are often stateful, as they tend to serve as data sources.</li>\n<li>Are usually generated using higher order components such as connect from React Redux, rather than written by hand.</li>\n</ul>\n<p>Komponenttien presentational vs. container -jaottelu on eräs hyväksi havaittu tapa strukturoida React-sovelluksia. Jako voi olla toimiva tai sitten ei, kaikki riippuu kontekstista.</p>\n<p>Abramov mainitsee jaon <a href=\"https://medium.com/@dan_abramov/smart-and-dumb-components-7ca2f9a7c7d0\">eduiksi</a> muunmuassa seuraavat</p>\n<ul>\n<li>Better separation of concerns. You understand your app and your UI better by writing components this way.</li>\n<li>Better reusability. You can use the same presentational component with completely different state sources, and turn those into separate container components that can be further reused.</li>\n<li>Presentational components are essentially your app’s “palette”. You can put them on a single page and let the designer tweak all their variations without touching the app’s logic. You can run screenshot regression tests on that page.</li>\n</ul>\n<p>Abramov mainitsee termin <a href=\"https://reactjs.org/docs/higher-order-components.html\">high order component</a>. Esim. <em>NoteList</em> on normaali komponentti, React-reduxin <em>connect</em> metodi taas on <em>high order komponentti</em>, eli käytännössä funktio, joka haluaa parametrikseen komponentin muuttuakseen \"normaaliksi\" komponentiksi.</p>\n<p>High order componentit eli HOC:t ovatkin yleinen tapa määritellä geneeristä toiminnallisuutta, joka sitten erikoistetaan esim. renderöitymisen määrittelyn suhteen parametrina annettavan komponentin avulla. Kyseessä on funktionaalisen ohjelmoinnin etäisesti olio-ohjelmoinnin perintää muistuttava käsite.</p>\n<p>HOC:it ovat oikeastaan käsitteen <a href=\"https://en.wikipedia.org/wiki/Higher-order_function\">High Order Function</a> (HOF) yleistys. HOF:eja ovat sellaiset funkiot, jotka joko ottavat parametrikseen funktioita tai palauttavat funkioita. Olemme oikeastaan käyttäneet HOF:eja läpi kurssin, esim. lähes kaikki taulukoiden käsittelyyn tarkoitetut metodit, kuten <em>map, filter ja find</em> ovat HOF:eja, samoin jo monta kertaa käyttämämme funktioita palauttavat (eli kahden nuolen) funktiot, esim.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">filterClicked</span> <span class=\"token operator\">=</span> value <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">filterChange</span><span class=\"token punctuation\">(</span>value<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Sovelluksen tämänhetkinen koodi on <a href=\"https://github.com/FullStack-HY/redux-notes/tree/part6-4\">githubissa</a> tagissa <em>part6-4</em>.</p>\n<p>Mukana on myös edellisestä unohtunut <em>VisibilityFilter</em>-komponentin <em>connect</em>-funktiota käyttävä versio, jota on myös paranneltu siten, että nappi <em>kaikki</em> on oletusarvoisesti valittuna. Koodissa on pieni ikävä copypaste mutta kelvatkoon.</p>\n<h2>Tehtäviä</h2>\n<p>Tee nyt tehtävät <a href=\"/teht%C3%A4v%C3%A4t#connect\">6.6-6.9</a></p>\n<h2>Redux-sovelluksen kommunikointi palvelimen kanssa</h2>\n<p>Laajennetaan sovellusta siten, että muistiinpanot talletetaan backendiin. Käytetään osasta 2 tuttua <a href=\"/osa2#datan-haku-palvelimelta\">json-serveriä</a>.</p>\n<p>Tallennetaan projektin juuren tiedostoon <em>db.json</em> tietokannan alkutila:</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"notes\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"content\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"reduxin storen toiminnan määrittelee reduceri\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"important\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">1</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">{</span>\n      <span class=\"token property\">\"content\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"storen tilassa voi olla mielivaltaista dataa\"</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"important\"</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span>\n      <span class=\"token property\">\"id\"</span><span class=\"token operator\">:</span> <span class=\"token number\">2</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">]</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Asennetaan projektiin json-server</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> json-server --save</code></pre></div>\n<p>ja lisätään tiedoston <em>package.json</em> osaan <em>scripts</em> rivi</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token string\">\"scripts\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token string\">\"server\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"json-server -p3001 db.json\"</span>,\n  // <span class=\"token punctuation\">..</span>.\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Käynnistetään json-server komennolla <em>npm run server</em>.</p>\n<p>Tehdään sitten tuttuun tapaan <em>axiosia</em> hyödyntävä backendistä dataa hakeva metodi tiedostoon <em>services/notes.js</em></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> axios <span class=\"token keyword\">from</span> <span class=\"token string\">'axios'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> getAll <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">'http://localhost:3001/notes'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span> getAll <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Asennetaan myös axios projektiin</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> axios --save</code></pre></div>\n<p>Muutetaan <em>nodeReducer</em>:issa tapahtuva muistiinpanojen tilan alustusta, siten että oletusarvoisesti mustiinpanoja ei ole:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">noteReducer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Nopea tapa saada storen tila alustettua palvelimella olevan datan perusteella on hakea muistiinpanot tiedostossa <em>index.js</em> ja dispatchata niille yksitellen action <em>NEW</em>NOTE_:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">import</span> noteService <span class=\"token keyword\">from</span> <span class=\"token string\">'./services/notes'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> reducer <span class=\"token operator\">=</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  notes<span class=\"token punctuation\">:</span> noteReducer<span class=\"token punctuation\">,</span>\n  filter<span class=\"token punctuation\">:</span> filterReducer<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>reducer<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nnoteService<span class=\"token punctuation\">.</span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>notes <span class=\"token operator\">=></span>\n  notes<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span>note <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    store<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> type<span class=\"token punctuation\">:</span> <span class=\"token string\">'NEW_NOTE'</span><span class=\"token punctuation\">,</span> data<span class=\"token punctuation\">:</span> note <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p>Lisätään reduceriin tuki actionille <em>INIT</em>NOTES<em>, jonka avulla alustus voidaan tehdä dispatchaamalla yksittäinen action. Luodaan myös sitä varten oma action creator -funktio _noteInitialization</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token comment\">// ...</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">noteReducer</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'ACTION:'</span><span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">switch</span> <span class=\"token punctuation\">(</span>action<span class=\"token punctuation\">.</span>type<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'NEW_NOTE'</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> <span class=\"token punctuation\">[</span><span class=\"token operator\">...</span>state<span class=\"token punctuation\">,</span> action<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">case</span> <span class=\"token string\">'INIT_NOTES'</span><span class=\"token punctuation\">:</span>\n      <span class=\"token keyword\">return</span> action<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">noteInitialization</span> <span class=\"token operator\">=</span> data <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    type<span class=\"token punctuation\">:</span> <span class=\"token string\">'INIT_NOTES'</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">// ...</span></code></pre></div>\n<p><em>index.js</em> yksinkertaistuu:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> noteReducer<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> noteInitialization <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers/noteReducer'</span><span class=\"token punctuation\">;</span>\n<span class=\"token comment\">// ...</span>\n\nnoteService<span class=\"token punctuation\">.</span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span>notes <span class=\"token operator\">=></span> store<span class=\"token punctuation\">.</span><span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token function\">noteInitialization</span><span class=\"token punctuation\">(</span>notes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<blockquote>\n<p><strong>HUOM:</strong> miksi emme käyttäneet koodissa promisejen ja <em>then</em>-metodilla rekisteröidyn tapahtumankäsittelijän sijaan awaitia?</p>\n<p>await toimii ainoastaan <em>async</em>-funktioiden sisällä, ja <em>index.js</em>:ssä oleva koodi ei ole funktiossa, joten päädyimme tilanteen yksinkertaisuuden takia tällä kertaa jättämään <em>async</em>:in käyttämättä.</p>\n</blockquote>\n<p>Päätetään kuitenkin siirtää muistiinpanojen alustus <em>App</em>-komponentin metodiin <em><a href=\"https://reactjs.org/docs/react-component.html#componentdidmount\">componentDidMount</a></em>, se on luonteva paikka alustuksille, sillä metodi suoritetaan heti sovelluksemme ensimmäisen renderöinnin jälkeen.</p>\n<p>Jotta saamme action creatorin <em>noteInitialization</em> käyttöön komponentissa <em>App</em> tarvitsemme jälleen <em>connect</em>-metodin apua:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport NoteForm from &#39;./components/NoteForm.js&#39;\nimport NoteList from &#39;./components/NoteList.js&#39;\nimport VisibilityFilter from &#39;./components/VisibilityFilter&#39;\nimport { connect } from &#39;react-redux&#39;\nimport { noteInitialization } from &#39;./reducers/noteReducer&#39;\nimport noteService from &#39;./services/notes&#39;\n\nclass App extends React.Component {\n  componentDidMount = async () =&gt; {\n    const notes = await noteService.getAll()\n    this.props.noteInitialization(notes)\n  }\n\n  render() {\n    return (\n      &lt;div&gt;\n        &lt;NoteForm /&gt;\n        &lt;VisibilityFilter /&gt;\n        &lt;NoteList /&gt;\n      &lt;/div&gt;\n    )\n  }\n}\n\nexport default connect(\n  null,\n  { noteInitialization }\n)(App)</code></pre></div>\n<p>Näin funktio <em>noteInitialization</em> tulee komponentin <em>App</em> propsiksi <em>this.props.noteInitialization</em> ja sen kutsumiseen ei tarvita <em>dispatch</em>-metodia koska <em>connect</em> hoitaa asian puolestamme.</p>\n<p>Pääsimme nyt myös käyttämään aina mukavaa async/awaitia. Palvelimen kanssa kommunikointi tapahtuu joka tapauksessa funktiossa, joten sen määrittely asyncina on vaivatonta:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">componentDidMount <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> notes <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> noteService<span class=\"token punctuation\">.</span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">noteInitialization</span><span class=\"token punctuation\">(</span>notes<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Voimme toimia samoin myös uuden muistiinpanon luomisen suhteen. Laajennetaan palvelimen kanssa kommunikoivaa koodia:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token string\">'http://localhost:3001/notes'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> getAll <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token keyword\">get</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> createNew <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> content <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> axios<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> content<span class=\"token punctuation\">,</span> important<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">.</span>data<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  getAll<span class=\"token punctuation\">,</span>\n  createNew<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Komponentin <em>NoteForm</em> metodi <em>addNote</em> muuttuu hiukan:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport { noteCreation } from &#39;./../reducers/noteReducer&#39;\nimport { connect } from &#39;react-redux&#39;\nimport noteService from &#39;../services/notes&#39;\n\nclass NoteForm extends React.Component {\n\n  addNote = async (event) =&gt; {\n    event.preventDefault()\n    const content = event.target.note.value\n    event.target.note.value = &#39;&#39;\n    const newNote = await noteService.createNew(content)\n    this.props.noteCreation(newNote)\n  }\n\n  render() {\n    //...\n  }\n}\n\nexport default connect(\n  null,\n  {noteCreation}\n)(NoteForm)</code></pre></div>\n<p>Koska backend generoi muistiinpanoille id:t, muutetaan action creator <em>noteCreation</em> muotoon</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">noteCreation</span> <span class=\"token operator\">=</span> data <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">{</span>\n    type<span class=\"token punctuation\">:</span> <span class=\"token string\">'NEW_NOTE'</span><span class=\"token punctuation\">,</span>\n    data<span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Muistiinpanojen tärkeyden muuttaminen olisi mahdollista toteuttaa samalla periaatteella, eli tehdä palvelimelle ensin asynkroninen metodikutsu ja sen jälkeen dispatchata sopiva action.</p>\n<p>Sovelluksen tämänhetkinen koodi on <a href=\"https://github.com/FullStack-HY/redux-notes/tree/part6-5\">githubissa</a> tagissä <em>part6-5</em>.</p>\n<h2>Tehtäviä</h2>\n<p>Tee nyt tehtävät <a href=\"/teht%C3%A4v%C3%A4t#redux-ja-backend\">6.10-6.12</a></p>\n<h3>Asynkroniset actionit ja redux thunk</h3>\n<p>Lähestymistapamme on ok, mutta siinä mielessä ikävä, että palvelimen kanssa kommunikointi tapahtuu komponenttien metodeissa. Olisi parempi, jos kommunikointi voitaisiin abstrahoida komponenteilta siten, että niiden ei tarvitsisi kuin kutsua sopivaa <em>action creatoria</em>, esim. <em>App</em> alustaisi sovelluksen tilan seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">App</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">componentDidMount</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">initializeNotes</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ja <em>NoteForm</em> loisi uuden muistiinpanon seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">NoteForm</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  addNote <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> event <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    event<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> content <span class=\"token operator\">=</span> event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>note<span class=\"token punctuation\">.</span>value<span class=\"token punctuation\">;</span>\n    event<span class=\"token punctuation\">.</span>target<span class=\"token punctuation\">.</span>note<span class=\"token punctuation\">.</span>value <span class=\"token operator\">=</span> <span class=\"token string\">''</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span><span class=\"token function\">createNote</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Molemmat komponentit käyttäisivät ainoastaan propsina saamaansa funktiota, välittämättä siitä että taustalla tapahtuu todellisuudessa palvelimen kanssa tapahtuvaa kommunikointia.</p>\n<p>Asennetaan nyt <a href=\"https://github.com/gaearon/redux-thunk\">redux-thunk</a>-kirjasto, joka mahdollistaa <em>asynkronisten actionien</em> luomisen. Asennus tapahtuu komennolla:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save redux-thunk</code></pre></div>\n<p>redux-thunk-kirjasto on ns. <em>redux-middleware</em> joka täytyy ottaa käyttöön storen alustuksen yhteydessä. Eriytetään samalla storen määrittely omaan tiedostoon <em>store.js</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> createStore<span class=\"token punctuation\">,</span> combineReducers<span class=\"token punctuation\">,</span> applyMiddleware <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'redux'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> thunk <span class=\"token keyword\">from</span> <span class=\"token string\">'redux-thunk'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">import</span> noteReducer <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers/noteReducer'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> filterReducer <span class=\"token keyword\">from</span> <span class=\"token string\">'./reducers/filterReducer'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> reducer <span class=\"token operator\">=</span> <span class=\"token function\">combineReducers</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  notes<span class=\"token punctuation\">:</span> noteReducer<span class=\"token punctuation\">,</span>\n  filter<span class=\"token punctuation\">:</span> filterReducer<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> store <span class=\"token operator\">=</span> <span class=\"token function\">createStore</span><span class=\"token punctuation\">(</span>reducer<span class=\"token punctuation\">,</span> <span class=\"token function\">applyMiddleware</span><span class=\"token punctuation\">(</span>thunk<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> store<span class=\"token punctuation\">;</span></code></pre></div>\n<p>Tiedosto <em>src/index.js</em> on muutoksen jälkeen seuraava</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import React from &#39;react&#39;\nimport ReactDOM from &#39;react-dom&#39;\nimport { Provider } from &#39;react-redux&#39;\nimport App from &#39;./App&#39;\nimport store from &#39;./store&#39;\n\nReactDOM.render(\n  &lt;Provider store={store}&gt;\n    &lt;App /&gt;\n  &lt;/Provider&gt;,\n  document.getElementById(&#39;root&#39;)\n)</code></pre></div>\n<p>redux-thunkin ansiosta on mahdollista määritellä <em>action creatoreja</em> siten, että ne palauttavat funktion, jonka parametrina on redux-storen <em>dispatch</em>-metodi. Tämän ansiosta on mahdollista tehdä asynkronisia action creatoreja, jotka ensin odottavat jonkin toimenpiteen valmistumista ja vasta sen jälkeen dispatchaavat varsinaisen actionin.</p>\n<p>Voimme nyt määritellä muistiinpanojen alkutilan palvelimelta hakevan action creatorin <em>initializeNotes</em> seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">initializeNotes</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">async</span> dispatch <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> notes <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> noteService<span class=\"token punctuation\">.</span><span class=\"token function\">getAll</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      type<span class=\"token punctuation\">:</span> <span class=\"token string\">'INIT_NOTES'</span><span class=\"token punctuation\">,</span>\n      data<span class=\"token punctuation\">:</span> notes<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Sisemmässä funktiossaan, eli <em>asynkronisessa actionissa</em> operaatio hakee ensin palvelimelta kaikki muistiinpanot ja sen jälkeen <em>dispatchaa</em> muistiinpanot storeen lisäävän actionin.</p>\n<p>Komponentti <em>App</em> voidaan nyt määritellä seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">class App extends React.Component {\n  componentDidMount () {\n    this.props.initializeNotes()\n  }\n\n  render() {\n    return (\n      &lt;div&gt;\n        &lt;NoteForm /&gt;\n        &lt;NoteList /&gt;\n        &lt;VisibilityFilter /&gt;\n      &lt;/div&gt;\n    )\n  }\n}\n\nexport default connect(\n  null, { initializeNotes }\n)(App)</code></pre></div>\n<p>Ratkaisu on elegantti, muistiinpanojen alustuslogiikka on eriytetty kokonaan React-komponenttien ulkopuolelle.</p>\n<p>Uuden muistiinpanon lisäävä action creator <em>createNew</em> on seuraavassa</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">createNew</span> <span class=\"token operator\">=</span> content <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">async</span> dispatch <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> newNote <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> noteService<span class=\"token punctuation\">.</span><span class=\"token function\">createNew</span><span class=\"token punctuation\">(</span>content<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token function\">dispatch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      type<span class=\"token punctuation\">:</span> <span class=\"token string\">'NEW_NOTE'</span><span class=\"token punctuation\">,</span>\n      data<span class=\"token punctuation\">:</span> newNote<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Periaate on jälleen sama, ensin suoritetaan asynkroninen operaatio, ja sen valmistuttua <em>dispatchataan</em> storen tilaa muuttava action.</p>\n<p>Lomake muuttuu seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">class NoteForm extends React.Component {\n\n  addNote = async (event) =&gt; {\n    event.preventDefault()\n    const content = event.target.note.value\n    event.target.note.value = &#39;&#39;\n    this.props.createNew(content)\n  }\n\n  render() {\n    return (\n      &lt;form onSubmit={this.addNote}&gt;\n        &lt;input name=&#39;note&#39; /&gt;\n        &lt;button&gt;lisää&lt;/button&gt;\n      &lt;/form&gt;\n    )\n  }\n}\n\nexport default connect(\n  null, { createNew }\n)(NoteForm)</code></pre></div>\n<p>Sovelluksen tämänhetkinen koodi on <a href=\"https://github.com/FullStack-HY/redux-notes/tree/part6-6\">githubissa</a> tagissä <em>part6-6</em>.</p>\n<h3>Redux DevTools</h3>\n<p>Chromeen on asennettavissa <a href=\"https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd\">Redux DevTools</a>, jonka avulla Redux-storen tilaa ja sitä muuttavia actioneja on mahdollisuus seurata selaimen konsolista.</p>\n<p>Selaimen lisäosan lisäksi debugatessa tarvitaan kirjastoa <a href=\"https://www.npmjs.com/package/redux-devtools-extension\">redux-devtools-extension</a>. Asennetaan se komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">npm install <span class=\"token operator\">--</span>save redux<span class=\"token operator\">-</span>devtools<span class=\"token operator\">-</span>extension</code></pre></div>\n<p>Storen luomistapaa täytyy hieman muuttaa, että kirjasto saadaan käyttöön:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">// ...\nimport { createStore, combineReducers, applyMiddleware } from &#39;redux&#39;\nimport thunk from &#39;redux-thunk&#39;\nimport { composeWithDevTools } from &#39;redux-devtools-extension&#39;\n\nimport noteReducer from &#39;./reducers/noteReducer&#39;\nimport filterReducer from &#39;./reducers/filterReducer&#39;\n\nconst reducer = combineReducers({\n  notes: noteReducer,\n  filter: filterReducer\n})\n\nconst store = createStore(\n  reducer,\n  composeWithDevTools(\n    applyMiddleware(thunk)\n  )\n)\n\nexport default store</code></pre></div>\n<p>Kun nyt avaat konsolin, välilehti <em>redux</em> näyttää seuraavalta:</p>\n<picture><img src=\"/static/4df255f283ff5181ab9a3039b5ca7cf6/14be6/5e.png\" srcset=\"/static/4df255f283ff5181ab9a3039b5ca7cf6/4cce7/5e.png 200w,\n/static/4df255f283ff5181ab9a3039b5ca7cf6/bae5f/5e.png 400w,\n/static/4df255f283ff5181ab9a3039b5ca7cf6/14be6/5e.png 800w,\n/static/4df255f283ff5181ab9a3039b5ca7cf6/1b35a/5e.png 1200w,\n/static/4df255f283ff5181ab9a3039b5ca7cf6/9ee03/5e.png 1600w,\n/static/4df255f283ff5181ab9a3039b5ca7cf6/b4549/5e.png 1896w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Konsolin avulla on myös mahdollista dispatchata actioneja storeen</p>\n<picture><img src=\"/static/7ee4e1c35e7391f5f880c7f88307d935/14be6/5f.png\" srcset=\"/static/7ee4e1c35e7391f5f880c7f88307d935/4cce7/5f.png 200w,\n/static/7ee4e1c35e7391f5f880c7f88307d935/bae5f/5f.png 400w,\n/static/7ee4e1c35e7391f5f880c7f88307d935/14be6/5f.png 800w,\n/static/7ee4e1c35e7391f5f880c7f88307d935/1b35a/5f.png 1200w,\n/static/7ee4e1c35e7391f5f880c7f88307d935/9ee03/5f.png 1600w,\n/static/7ee4e1c35e7391f5f880c7f88307d935/e829b/5f.png 1730w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Storen tietyn hetkisen tilan lisäksi on myös mahdollista tarkastella, mikä on kunkin actionin tilalle aiheuttama muutos:</p>\n<picture><img src=\"/static/408ae9b7ac135ad5e5259b2bbd7c94a6/14be6/5g.png\" srcset=\"/static/408ae9b7ac135ad5e5259b2bbd7c94a6/4cce7/5g.png 200w,\n/static/408ae9b7ac135ad5e5259b2bbd7c94a6/bae5f/5g.png 400w,\n/static/408ae9b7ac135ad5e5259b2bbd7c94a6/14be6/5g.png 800w,\n/static/408ae9b7ac135ad5e5259b2bbd7c94a6/1b35a/5g.png 1200w,\n/static/408ae9b7ac135ad5e5259b2bbd7c94a6/9ee03/5g.png 1600w,\n/static/408ae9b7ac135ad5e5259b2bbd7c94a6/e6773/5g.png 1850w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<h2>tehtäviä</h2>\n<p>Tee nyt tehtävät <a href=\"/teht%C3%A4v%C3%A4t#thunk\">6.13-6.15</a></p>\n<h2>React router</h2>\n<p>Palataan jälleen Reduxittoman Reactin pariin.</p>\n<p>On erittäin tyypillistä, että web-sovelluksissa on navigaatiopalkki, jonka avulla on mahdollista vaihtaa sovelluksen näkymää. Muistiinpanosovelluksemme voisi sisältää pääsivun:</p>\n<picture><img src=\"/static/9dede0061c8eac733e37e2e60d2717b6/14be6/6.png\" srcset=\"/static/9dede0061c8eac733e37e2e60d2717b6/4cce7/6.png 200w,\n/static/9dede0061c8eac733e37e2e60d2717b6/bae5f/6.png 400w,\n/static/9dede0061c8eac733e37e2e60d2717b6/14be6/6.png 800w,\n/static/9dede0061c8eac733e37e2e60d2717b6/1b35a/6.png 1200w,\n/static/9dede0061c8eac733e37e2e60d2717b6/7db0f/6.png 1240w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>ja omat sivunsa muistiinpanojen ja käyttäjien tietojen näyttämiseen:</p>\n<picture><img src=\"/static/5b335e01f8915d3c3cab42be7f78460c/14be6/7.png\" srcset=\"/static/5b335e01f8915d3c3cab42be7f78460c/4cce7/7.png 200w,\n/static/5b335e01f8915d3c3cab42be7f78460c/bae5f/7.png 400w,\n/static/5b335e01f8915d3c3cab42be7f78460c/14be6/7.png 800w,\n/static/5b335e01f8915d3c3cab42be7f78460c/1b35a/7.png 1200w,\n/static/5b335e01f8915d3c3cab42be7f78460c/7db0f/7.png 1240w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p><a href=\"/osa0#perinteinen-web-sovellus\">Vanhan koulukunnan websovelluksessa</a> sovelluksen näyttämän sivun vaihto tapahtui siten että selain teki palvelimelle uuden HTTP GET -pyynnön ja renderöi sitten palvelimen palauttaman näkymää vastaavan HTML-koodin.</p>\n<p>Single page appeissa taas ollaan todellisuudessa koko ajan samalla sivulla, ja selaimessa suoritettava Javascript-koodi luo illuusion eri \"sivuista\". Jos näkymää vaihdettaessa tehdään HTTP-kutsuja, niiden avulla haetaan ainoastaan JSON-muotoista dataa jota uuden näkymän näyttäminen ehkä edellyttää.</p>\n<p>Navigaatiopalkki ja useita näkymiä sisältävä sovellus on erittäin helppo toteuttaa Reactilla.</p>\n<p>Seuraavassa on eräs tapa:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">const Home = () =&gt; (\n  &lt;div&gt; &lt;h2&gt;TKTL notes app&lt;/h2&gt; &lt;/div&gt;\n)\n\nconst Notes = () =&gt; (\n  &lt;div&gt; &lt;h2&gt;Notes&lt;/h2&gt; &lt;/div&gt;\n)\n\nconst Users = () =&gt; (\n  &lt;div&gt; &lt;h2&gt;Users&lt;/h2&gt; &lt;/div&gt;\n)\n\nclass App extends React.Component {\n  constructor() {\n    super()\n    this.state = {\n      page: &#39;home&#39;\n    }\n  }\n\n  toPage = (page) =&gt; (event) =&gt; {\n    event.preventDefault()\n    this.setState({ page })\n  }\n\n  render() {\n    const content = () =&gt; {\n      if (this.state.page === &#39;home&#39;) {\n        return &lt;Home /&gt;\n      } else if (this.state.page === &#39;notes&#39;) {\n        return &lt;Notes /&gt;\n      } else if (this.state.page === &#39;users&#39;) {\n        return &lt;Users /&gt;\n      }\n    }\n\n    return (\n      &lt;div&gt;\n        &lt;div&gt;\n          &lt;a href=&quot;&quot; onClick={ this.toPage(&#39;home&#39;) }&gt;home&lt;/a&gt; &amp;nbsp;\n          &lt;a href=&quot;&quot; onClick={ this.toPage(&#39;notes&#39;) }&gt;notes&lt;/a&gt; &amp;nbsp;\n          &lt;a href=&quot;&quot; onClick={ this.toPage(&#39;users&#39;) }&gt;users&lt;/a&gt;\n        &lt;/div&gt;\n\n        {content()}\n      &lt;/div&gt;\n    )\n  }\n}</code></pre></div>\n<p>Eli jokainen näkymä on toteutettu omana komponenttinaan ja sovelluksen tilassa pidetään tieto siitä, minkä näkymää vastaava komponentti menupalkin alla näytetään.</p>\n<p><strong>Huom:</strong> navigointivalikossa oleva <em>&#x26;nbsp;</em> tarkoittaa <em>a</em>-tagien väliin sjijoitettavaa välilyöntiä. CSS:n käyttö olisi luonnollisesti parempi tapa sivun ulkoasun muotoilulle mutta nyt tyydymme quick'n'dirty-ratkaisuun.</p>\n<p>Menetelmä ei kuitenkaan ole optimaalinen. Kuten kuvista näkyy, sivuston osoite pysyy samana vaikka välillä ollaankin eri näkymässä. Jokaisella näkymällä tulisi kuitenkin olla oma osoitteensa, jotta esim. bookmarkien tekeminen olisi mahdollista. Sovelluksessamme ei myöskään selaimen <em>back</em>-painike toimi loogisesti, eli <em>back</em> ei vie edelliseksi katsottuun sovelluksen näkymään vaan jonnekin ihan muualle. Jos sovellus kasvaisi suuremmaksi ja sinne haluttaisiin esim. jokaiselle käyttäjälle sekä muistiinpanolle oma yksittäinen näkymänsä, itse koodattu <em>reititys</em> eli sivuston navigaationhallinta menisi turhan monimutkaiseksi.</p>\n<p>Reactissa on onneksi valmis komponentti <a href=\"https://github.com/ReactTraining/react-router\">React router</a> joka tarjoaa erinomaisen ratkaisun React-sovelluksen navigaation hallintaan.</p>\n<p>Muutetaan ylläoleva sovellus käyttämään React routeria. Asennetaan React router komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save react-router-dom</code></pre></div>\n<p>React routerin tarjoama reititys saadaan käyttöön muuttamalla sovellusta seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import { BrowserRouter as Router, Route, Link } from &#39;react-router-dom&#39;\n\nclass App extends React.Component {\n\n  render() {\n    return (\n      &lt;div&gt;\n        &lt;Router&gt;\n          &lt;div&gt;\n            &lt;div&gt;\n              &lt;Link to=&quot;/&quot;&gt;home&lt;/Link&gt; &amp;nbsp;\n              &lt;Link to=&quot;/notes&quot;&gt;notes&lt;/Link&gt; &amp;nbsp;\n              &lt;Link to=&quot;/users&quot;&gt;users&lt;/Link&gt;\n            &lt;/div&gt;\n            &lt;Route exact path=&quot;/&quot; render={() =&gt; &lt;Home /&gt;} /&gt;\n            &lt;Route path=&quot;/notes&quot; render={() =&gt; &lt;Notes /&gt;} /&gt;\n            &lt;Route path=&quot;/users&quot; render={() =&gt; &lt;Users /&gt;} /&gt;\n          &lt;/div&gt;\n        &lt;/Router&gt;\n      &lt;/div&gt;\n    )\n  }\n}</code></pre></div>\n<p>Reititys, eli komponenttien ehdollinen, selaimen <em>urliin perustuva</em> renderöinti otetaan käyttöön sijoittamalla komponentteja <em>Router</em>-komponentin lapsiksi, eli <em>Router</em>-tagien sisälle.</p>\n<p>Huomaa, että vaikka komponenttiin viitataan nimellä <em>Router</em> kyseessä on <a href=\"https://reacttraining.com/react-router/web/api/BrowserRouter\">BrowserRouter</a>, sillä\nimporttaus tapahtuu siten, että importattava olio uudelleennimetään:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> BrowserRouter <span class=\"token keyword\">as</span> Router <span class=\"token operator\">...</span> <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-router-dom'</span></code></pre></div>\n<p>Manuaalin mukaan</p>\n<blockquote>\n<p><em>BrowserRouter</em> is a <em>Router</em> that uses the HTML5 history API (pushState, replaceState and the popstate event) to keep your UI in sync with the URL.</p>\n</blockquote>\n<p>Normaalisti selain lataa uuden sivun osoiterivillä olevan urlin muuttuessa. <a href=\"https://css-tricks.com/using-the-html5-history-api/\">HTML5 history API</a>:n avulla <em>BrowserRouter</em> kuitenkin mahdollistaa sen, että selaimen osoiterivillä olevaa urlia voidaan käyttää React-sovelluksen sisäiseen \"reitittämiseen\", eli vaikka osoiterivillä oleva url muuttuu, sivun sisältöä manipuloidaan ainoastaan Javascriptillä ja selain ei lataa uutta sisältöä palvelimelta. Selaimen toiminta back- ja forward-toimintojen ja bookmarkien tekemisen suhteen on kuitenkin loogista, eli toimii kuten perinteisillä web-sivuilla.</p>\n<p>Routerin sisälle määritellään selaimen osoiteriviä muokkaavia <em>linkkejä</em> komponentin <a href=\"https://reacttraining.com/react-router/web/api/Link\">Link</a> avulla. Esim.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/notes\"</span><span class=\"token operator\">></span>notes<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span></code></pre></div>\n<p>luo sovellukseen linkin, jonka teksti on <em>notes</em> ja jonka klikkaaminen vaihtaa selaimen osoiteriville urliksi <em>/notes</em>.</p>\n<p>Selaimen urliin perustuen renderöitävät komponentit määritellään komponentin <a href=\"https://reacttraining.com/react-router/web/api/Route\">Route</a> avulla. Esim.</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">\"/notes\"</span> render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Notes /<span class=\"token operator\">></span><span class=\"token punctuation\">}</span> /<span class=\"token operator\">></span></code></pre></div>\n<p>määrittelee, että jos selaimen osoiteena on <em>/notes</em>, renderöidään komponentti <em>Notes</em>.</p>\n<p>Sovelluksen juuren, eli osoitteen <em>/</em> määritellään renderöivän komponentti <em>Home</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Route exact path<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span> render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Home /<span class=\"token operator\">></span><span class=\"token punctuation\">}</span> /<span class=\"token operator\">></span></code></pre></div>\n<p>joudumme käyttämään routen <em>path</em> attribuutin edessä määrettä <em>exact</em>, muuten <em>Home</em> renderöityy kaikilla muillakin poluilla, sillä juuri <em>/</em> on kaikkien muiden polkujen <em>alkuosa</em>.</p>\n<h3>parametroitu route</h3>\n<p>Tarkastellaan sitten hieman modifioitua versiota edellisestä esimerkistä. Esimerkin koodi kokonaisuudessaan on <a href=\"https://github.com/FullStack-HY/FullStack-Hy.github.io/wiki/router-esimerkki\">täällä</a>.</p>\n<p>Sovellus sisältää nyt viisi eri näkymää, joiden näkyvyyttä kontrolloidaan routerin avulla. Edellisestä esimerkistä tuttujen komponenttien <em>Home</em>, <em>Notes</em> ja <em>Users</em> lisäksi mukana on kirjautumisnäkymää vastaava <em>Login</em> ja yksittäisen muistiinpanon näkymää vastaava <em>Note</em>.</p>\n<p><em>Home</em> ja <em>Users</em> ovat kuten aiemmassa esimerkissä. <em>Notes</em> on hieman monimutkaisempi, se renderöi propseina saamansa muistiinpanojen listan siten, että jokaisen muistiinpanon nimi on klikattavissa</p>\n<picture><img src=\"/static/c734eb7d3963d927a2849f6d2967e9e1/14be6/8.png\" srcset=\"/static/c734eb7d3963d927a2849f6d2967e9e1/4cce7/8.png 200w,\n/static/c734eb7d3963d927a2849f6d2967e9e1/bae5f/8.png 400w,\n/static/c734eb7d3963d927a2849f6d2967e9e1/14be6/8.png 800w,\n/static/c734eb7d3963d927a2849f6d2967e9e1/1b35a/8.png 1200w,\n/static/c734eb7d3963d927a2849f6d2967e9e1/b03d6/8.png 1330w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Nimen klikattavuus on toteutettu komponentilla <em>Link</em> ja esim. muistiinpanon, jonka id on 3 nimen klikkaaminen aiheuttaa selaimen osoitteen arvon päivittymisen muotoon <em>notes/3</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">const Notes = ({notes}) =&gt; (\n  &lt;div&gt;\n    &lt;h2&gt;Notes&lt;/h2&gt;\n    &lt;ul&gt;\n      {notes.map(note=&gt;\n        &lt;li key={note.id}&gt;\n          &lt;Link to={`/notes/${note.id}`}&gt;{note.content}&lt;/Link&gt;\n        &lt;/li&gt;\n      )}\n    &lt;/ul&gt;\n  &lt;/div&gt;\n)</code></pre></div>\n<p>Kun selain siirtyy muistiinpanon yksilöivään osoitteeseen, esim. <em>notes/3</em>, renderöidään komponentti <em>Note</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">const Note = ({note}) =&gt; {\n  return(\n  &lt;div&gt;\n    &lt;h2&gt;{note.content}&lt;/h2&gt;\n    &lt;div&gt;{note.user}&lt;/div&gt;\n    &lt;div&gt;&lt;strong&gt;{note.important ? &#39;tärkeä&#39; : &#39;&#39;}&lt;/strong&gt;&lt;/div&gt;\n  &lt;/div&gt;\n)}</code></pre></div>\n<p>Tämä tapahtuu laajentamalla komponentissa <em>App</em> olevaa reititystä seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Router<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span><span class=\"token operator\">></span>home<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/notes\"</span><span class=\"token operator\">></span>notes<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/users\"</span><span class=\"token operator\">></span>users<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span>\n      <span class=\"token operator\">&lt;</span>/div<span class=\"token operator\">></span>\n\n      <span class=\"token operator\">&lt;</span>Route exact path<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span> render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span> <span class=\"token operator\">&lt;</span>Home /<span class=\"token operator\">></span><span class=\"token punctuation\">}</span> /<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Route exact path<span class=\"token operator\">=</span><span class=\"token string\">\"/notes\"</span> render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Notes notes<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>this.state.notes<span class=\"token punctuation\">}</span> /<span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\n      /<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Route exact path<span class=\"token operator\">=</span><span class=\"token string\">\"/notes/:id\"</span> render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>match<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Note note<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>noteById<span class=\"token punctuation\">(</span>match.params.id<span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span> /<span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\n      /<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>/div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>/Router<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/div<span class=\"token operator\">></span></code></pre></div>\n<p>Kaikki muistiinpanon renderöivään routeen on lisätty määre <em>exact path=\"/notes\"</em> sillä muuten se renderöityisi myös <em>/notes/3</em>-muotoisten polkujen yhteydessä.</p>\n<p>Yksittäisen muistiinpanon näkymän renderöivä route määritellään \"expressin tyyliin\" merkkaamalla reitin parametrina oleva osa merkinnällä <em>:id</em></p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">&lt;Route exact path=&quot;/notes/:id&quot; /&gt;</code></pre></div>\n<p>Renderöityvän komponentin määrittävä <em>render</em>-attribuutti pääsee käsiksi id:hen parametrinsa <a href=\"https://reacttraining.com/react-router/web/api/match\">match</a> avulla seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">render={({match}) =&gt; &lt;Note note={noteById(match.params.id)} /&gt;}</code></pre></div>\n<p>Muuttujassa <em>match.params.id</em> olevaa id:tä vastaava muistiinpano selvitetään apufunktion <em>noteById</em> avulla</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">const noteById = (id) =&gt;\n  this.state.notes.find(note =&gt; note.id === Number(id))</code></pre></div>\n<p>renderöityvä <em>Note</em>-komponentti saa siis propsina urlin yksilöivää osaa vastaavan muistiinpanon.</p>\n<h3>history</h3>\n<p>Sovellukseen on myös toteutettu erittäin yksinkertainen kirjautumistoiminto. Jos sovellukseen ollaan kirjautuneena, talletetaan tieto kirjautuneesta käyttäjästä komponentin <em>App</em> tilaan <em>this.state.user</em>.</p>\n<p>Mahdollisuus <em>Login</em>-näkymään navigointiin renderöidään menuun ehdollisesti</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Router<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span><span class=\"token operator\">></span>home<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span>\n      <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/notes\"</span><span class=\"token operator\">></span>notes<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span>\n      <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/users\"</span><span class=\"token operator\">></span>users<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span> <span class=\"token operator\">&amp;</span>nbsp<span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">{</span>this.state.user\n        ? <span class=\"token operator\">&lt;</span>em<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>this.state.user<span class=\"token punctuation\">}</span> logged in<span class=\"token operator\">&lt;</span>/em<span class=\"token operator\">></span>\n        <span class=\"token keyword\">:</span> <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/login\"</span><span class=\"token operator\">></span>login<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span>/div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">..</span>.\n  <span class=\"token operator\">&lt;</span>/div<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/Router<span class=\"token operator\">></span></code></pre></div>\n<p>eli jos käyttäjä on kirjaantunut, renderöidäänkin linkin <em>Login</em> sijaan kirjautuneen käyttäjän käyttäjätunnus:</p>\n<picture><img src=\"/static/9d8e5389508c4a3415ca5140d00ad25b/14be6/9.png\" srcset=\"/static/9d8e5389508c4a3415ca5140d00ad25b/4cce7/9.png 200w,\n/static/9d8e5389508c4a3415ca5140d00ad25b/bae5f/9.png 400w,\n/static/9d8e5389508c4a3415ca5140d00ad25b/14be6/9.png 800w,\n/static/9d8e5389508c4a3415ca5140d00ad25b/1b35a/9.png 1200w,\n/static/9d8e5389508c4a3415ca5140d00ad25b/b7120/9.png 1566w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Kirjautumisen toteuttamiseen liittyy eräs mielenkiintoinen seikka. Kirjaantumislomakkeelle mennään selaimen osoitteen ollessa <em>/login</em>. Toiminnallisuuden määrittelevä Route on seuraavassa</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">\"/login\"</span> render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>history<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Login history<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>history<span class=\"token punctuation\">}</span> onLogin<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>this.login<span class=\"token punctuation\">}</span> /<span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\n/<span class=\"token operator\">></span></code></pre></div>\n<p>Routen render-attribuutissa määritelty metodi ottaa nyt vastaan olion <a href=\"https://reacttraining.com/react-router/web/api/history\">history</a>, joka tarjoaa mm. mahdollisuuden manipuloida selaimen osoiterivin arvoa ohjelmallisesti.</p>\n<p>Renderöitävälle <em>Login</em>-näkymälle annetaan parametriksi <em>history</em>-olio ja kirjautumisen komponentin <em>App</em> tilaan synkronoiva funktio <em>this.login</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Login history<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>history<span class=\"token punctuation\">}</span> onLogin<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>this.login<span class=\"token punctuation\">}</span>/<span class=\"token operator\">></span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>Komponentin koodi seuraavassa</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">const Login = ({onLogin, history}) =&gt; {\n  const onSubmit = (event) =&gt; {\n    event.preventDefault()\n    onLogin(event.target.username.value)\n    history.push(&#39;/&#39;)\n  }\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;login&lt;/h2&gt;\n      &lt;form onSubmit={onSubmit}&gt;\n        &lt;div&gt;\n          username: &lt;input /&gt;\n        &lt;/div&gt;\n        &lt;div&gt;\n          password: &lt;input type=&quot;password&quot; /&gt;\n        &lt;/div&gt;\n        &lt;button type=&quot;submit&quot;&gt;login&lt;/button&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n  )\n}</code></pre></div>\n<p>Kirjautumisen yhteydessä funktiossa <em>onSubmit</em> kutsutaan <a href=\"https://reacttraining.com/react-router/web/api/history\">history</a>-olion metodia <em>push</em>. Käytetty komento <code>history.push('/')</code> saa aikaan sen, että selaimen osoiteriville tulee osoitteeksi <em>/</em> ja sovellus renderöi osoitetta vastaavan komponentin <em>Home</em>.</p>\n<h3>redirect</h3>\n<p>Näkymän <em>Users</em> routeen liittyy vielä eräs mielenkiintoinen detalji:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Route path<span class=\"token operator\">=</span><span class=\"token string\">\"/users\"</span> render<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=</span><span class=\"token operator\">></span>\n  this.state.user\n    ? <span class=\"token operator\">&lt;</span>Users /<span class=\"token operator\">></span>\n    <span class=\"token keyword\">:</span> <span class=\"token operator\">&lt;</span>Redirect to<span class=\"token operator\">=</span><span class=\"token string\">\"/login\"</span> /<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>/<span class=\"token operator\">></span></code></pre></div>\n<p>Jos käyttäjä ei ole kirjautuneena, ei renderöidäkään näkymää <em>Users</em> vaan sen sijaan <em>uudelleenohjataan</em> käyttäjä <em>Redirect</em>-komponentin avulla kirjautumisnäkymään</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">&lt;Redirect to=&quot;/login&quot; /&gt;</code></pre></div>\n<p>Todellisessa sovelluksessa olisi kenties parempi olla kokonaan näyttämättä navigaatiovalikossa kirjautumista edellyttäviä näkymiä jos käyttäjä ei ole kirjautunut sovellukseen.</p>\n<p>Seuraavassa vielä komponentin <em>App</em> koodi kokonaisuudessaan:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">class App extends React.Component {\n  constructor() {\n    super()\n    this.state = {\n      notes: [\n        {\n          id: 1,\n          content: &#39;HTML on helppoa&#39;,\n          important: true,\n          user: &#39;Matti Luukkainen&#39;\n        },\n        // ...\n      ],\n      user: null\n    }\n  }\n\n  login = (user) =&gt; {\n    this.setState({user})\n  }\n\n  render() {\n    const noteById = (id) =&gt;\n      this.state.notes.find(note =&gt; note.id === Number(id))\n\n    return (\n      &lt;div&gt;\n        &lt;Router&gt;\n          &lt;div&gt;\n            &lt;div&gt;\n              &lt;Link to=&quot;/&quot;&gt;home&lt;/Link&gt; &amp;nbsp;\n              &lt;Link to=&quot;/notes&quot;&gt;notes&lt;/Link&gt; &amp;nbsp;\n              &lt;Link to=&quot;/users&quot;&gt;users&lt;/Link&gt; &amp;nbsp;\n              {this.state.user\n                ? &lt;em&gt;{this.state.user} logged in&lt;/em&gt;\n                : &lt;Link to=&quot;/login&quot;&gt;login&lt;/Link&gt;\n              }\n            &lt;/div&gt;\n\n            &lt;Route exact path=&quot;/&quot; render={() =&gt; &lt;Home /&gt;} /&gt;\n            &lt;Route exact path=&quot;/notes&quot; render={() =&gt; &lt;Notes notes={this.state.notes}/&gt;} /&gt;\n            &lt;Route exact path=&quot;/notes/:id&quot; render={({match}) =&gt;\n              &lt;Note note={noteById(match.params.id)} /&gt;}\n            /&gt;\n            &lt;Route path=&quot;/users&quot; render={() =&gt;\n              this.state.user\n                ? &lt;Users /&gt;\n                : &lt;Redirect to=&quot;/login&quot; /&gt;\n              }/&gt;\n            &lt;Route path=&quot;/login&quot; render={({history}) =&gt;\n              &lt;Login history={history} onLogin={this.login} /&gt;}\n            /&gt;\n          &lt;/div&gt;\n        &lt;/Router&gt;\n        &lt;div&gt;\n          &lt;em&gt;Note app, Department of Computer Science 2018&lt;/em&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n    )\n  }\n}</code></pre></div>\n<p>Render-metodissa määritellään myös kokonaan <em>Router</em>:in ulkopuolella oleva nykyisille web-sovelluksille tyypillinen <em>footer</em>-elementti, eli sivuston pohjalla oleva osa, joka on näkyvillä riippumatta siitä mikä komponentti sovelluksen reititetyssä osassa näytetään.</p>\n<p><strong>Huom:</strong> edellä olevassa esimerkissä käytetään React Routerin versiota 4.2.6. Jos ja kun etsit esimerkkejä internetistä, kannattaa varmistaa, että niissä käytetään Routerista vähintään versiota 4.0. Nelosversio ei ole ollenkaan alaspäinyhteensopiva kolmosen kanssa, eli vanhaa React Routeria käyttävä koodi on täysin käyttökelvotonta Routerin versiota 4 käytettäessä.</p>\n<h2>tehtäviä</h2>\n<p>Tee nyt tehtävät <a href=\"/teht%C3%A4v%C3%A4t#router\">6.16-6.18</a></p>\n<h2>Inline-tyylit</h2>\n<p>Osan 2 <a href=\"/osa2#tyylien-lis%C3%A4%C3%A4minen\">lopussa</a> lisäsimme React-sovellukseen tyylejä vanhan koulukunnan tapaan yhden koko sovelluksen tyylit määrittelevän CSS-tiedoston avulla.</p>\n<p>Olemme jo muutamaan kertaan määritelleet komponenteille <a href=\"https://react-cn.github.io/react/tips/inline-styles.html\">inline</a>-tyylejä, eli määritelleet CSS:ää suoraan komponentin muun koodin seassa.</p>\n<p>Edellisessä osassa piilotimme inline-tyylin avulla napin ruudusta tietyissä tapauksissa:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">const hideWhenVisible = { display: this.state.visible ? &#39;none&#39; : &#39;&#39; }\n\n&lt;div style={hideWhenVisible}&gt;\n  &lt;button onClick={this.toggleVisibility}&gt;{this.props.buttonLabel}&lt;/button&gt;\n&lt;/div&gt;</code></pre></div>\n<p>eli jos <em>this.state.visible</em> oli arvoltaan tosi, liitetään <em>div</em>-komponenttiin sen näkymättömäksi asettava tyyli</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\">{ display: &#39;none&#39; }</code></pre></div>\n<p>Periaate inline-tyylien määrittelyssä on siis erittäin yksinkertainen. Mihin tahansa React-komponenttiin tai elementtiin voi liittää attribuutin <em>style</em>, jolle annetaan arvoksi Javascript-oliona määritelty joukko <em>CSS</em>-sääntöjä.</p>\n<p>CSS-säännöt määritellään hieman eri tavalla kuin normaaleissa CSS-tiedostoissa. Jos haluamme asettaa jollekin elementille vihreän, kursivoidun ja 16 pikselin korkuisen fontin, eli CSS-syntaksilla ilmaistuna</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\">{\n  color: green;\n  font-style: italic;\n  font-size: 16px;\n}</code></pre></div>\n<p>tulee tämä muotilla Reactin inline-tyylin määrittelevänä oliona seuraavasti</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> footerStyle <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  color<span class=\"token punctuation\">:</span> <span class=\"token string\">'green'</span><span class=\"token punctuation\">,</span>\n  fontStyle<span class=\"token punctuation\">:</span> <span class=\"token string\">'italic'</span><span class=\"token punctuation\">,</span>\n  fontSize<span class=\"token punctuation\">:</span> <span class=\"token number\">16</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Jokainen CSS-sääntö on olion kenttä, joten ne erotetaan Javascript-syntaksin mukaan pilkuilla. Pikseleinä ilmaistut numeroarvot voidaan määritellä kokonaislukuina. Merkittävin ero normaaliin CSS:ään on väliviivan sisältämien CSS-ominaisuuksien kirjoittaminen <em>camelCase</em>-muodossa.</p>\n<p>Voimme muotoilla edellisen luvun footer-elementin olion <em>footerStyle</em> avulla seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>footerStyle<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>br /<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>em<span class=\"token operator\">></span>Note app, Department of Computer Science 2018<span class=\"token operator\">&lt;</span>/em<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/div<span class=\"token operator\">></span></code></pre></div>\n<p>Inline-tyyleillä on tiettyjä rajoituksia, esim. ns. <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/Pseudo-classes\">pseudo-selektoreja</a> ei ole mahdollisuutta käyttää (ainakaan helposti).</p>\n<p>Inline-tyylit ja muutamat seuraavassa osassa katsomamme tavat lisätä tyylejä Reactiin ovat periaatteessa täysin vastoin vanhoja hyviä periaatteita, joiden mukaan Web-sovellusten ulkoasujen määrittely eli CSS tulee erottaa sisällön (HTML) ja toiminnallisuuden (Javascript) määrittelystä. Vanha koulukunta pyrkiikin siihen että sovelluksen CSS, HTML ja Javascript on kaikki kirjoitettu omiin tiedostoihinsa.</p>\n<p>Itseasiassa Reactin filosofia on täysin päinvastainen. Koska CSS:n, HTML:n ja Javascriptin erottelu eri tiedostoihin ei ole kuitenkaan osoittautunut erityisen skaalautuvaksi ratkaisuksi suurissa järjestelmissä, on Reactissa periaatteena tehdä erottelu (eli jakaa sovelluksen koodi eri tiedostoihin) noudattaen <em>sovelluksen loogisia toiminnallisia kokonaisuuksia</em>.</p>\n<p>Toiminnallisen kokonaisuuden strukturointiyksikkö on React-komponentti, joka määrittelee niin sisällön rakenteen kuvaavan HTML:n, toiminnan määrittelevät Javascript-funktiot kuin komponentin tyylinkin yhdessä paikassa, siten että komponenteista tulee mahdollisimman riippumattomia ja yleiskäyttöisiä.</p>\n<h2>tehtäviä</h2>\n<p>Tee nyt tehtävät <a href=\"/teht%C3%A4v%C3%A4t#inline-tyylit\">6.19 ja 6.20</a></p>\n<h2>Valmiit käyttöliittymätyylikirjastot</h2>\n<p>Eräs lähestymistapa sovelluksen tyylien määrittelyyn on valmiin \"UI frameworkin\", eli suomeksi ehkä käyttöliittymätyylikirjaston käyttö.</p>\n<p>Ensimmäinen laajaa kuuluisuutta saanut UI framework oli Twitterin kehittämä <a href=\"https://getbootstrap.com/\">Bootstrap</a>, joka lienee edelleen UI frameworkeista eniten käytetty. Viime aikoina UI frameworkeja on noussut kuin sieniä sateella. Valikoima on niin iso, ettei tässä kannata edes yrittää tehdä tyhjentävää listaa.</p>\n<p>Monet UI-frameworkit sisältävät web-sovellusten käyttöön valmiiksi määriteltyjä teemoja sekä \"komponentteja\", kuten painikkeita, menuja, taulukkoja. Termi komponentti on edellä kirjotettu hipsuissa sillä kyse ei ole samasta asiasta kuin React-komponentti. Useimmiten UI-frameworkeja käytetään sisällyttämällä sovellukseen frameworkin määrittelemät CSS-tyylitiedostot sekä Javascript-koodi.</p>\n<p>Monesta UI-frameworkista on tehty React-ystävällisiä versiota, joissa UI-frameworkin avulla määritellyistä \"komponenteista\" on tehty React-komponentteja. Esim. Bootstrapista on olemassa parikin React-versiota <a href=\"http://reactstrap.github.io/\">reactstrap</a> ja <a href=\"https://react-bootstrap.github.io/\">react-bootstrap</a>.</p>\n<p>Katsotaan seuraavaksi kahta UI-framworkia bootstrapia ja <a href=\"https://semantic-ui.com/\">semantic ui</a>:ta.\nLisätään molempien avulla samantapaiset tyylit luvun <a href=\"/osa6/#react-router\">React-router</a> sovellukseen.</p>\n<h3>react bootstrap</h3>\n<p>Aloitetaan bootstrapista, käytetään kirjastoa <a href=\"https://react-bootstrap.github.io/\">react-bootstrap</a>.</p>\n<p>Asennetaan kirjasto suorittamalla komento</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save react-bootstrap</code></pre></div>\n<p>Lisätään sitten sovelluksen <em>public/index.html</em> tiedoston <em>head</em>-tagin sisään bootstrapin css-määrittelyt lataava rivi:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span>\n    <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">integrity</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u<span class=\"token punctuation\">\"</span></span>\n    <span class=\"token attr-name\">crossorigin</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>anonymous<span class=\"token punctuation\">\"</span></span>\n  <span class=\"token punctuation\">/></span></span>\n  // ...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Kun sovellus ladataan uudelleen, näyttää se jo aavistuksen tyylikkäämmältä:</p>\n<picture><img src=\"/static/b914b0fefd57ab72760d4c8a8e32445b/14be6/10.png\" srcset=\"/static/b914b0fefd57ab72760d4c8a8e32445b/4cce7/10.png 200w,\n/static/b914b0fefd57ab72760d4c8a8e32445b/bae5f/10.png 400w,\n/static/b914b0fefd57ab72760d4c8a8e32445b/14be6/10.png 800w,\n/static/b914b0fefd57ab72760d4c8a8e32445b/1b35a/10.png 1200w,\n/static/b914b0fefd57ab72760d4c8a8e32445b/cbaf6/10.png 1404w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Bootstrapissa koko sivun sisältö renderöidään yleensä <a href=\"https://getbootstrap.com/docs/4.0/layout/overview/#containers\">container</a>:ina, eli käytännössä koko sovelluksen ympäröivä <em>div</em>-elementti merkitään luokalla <em>container</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">// ...\n\nclass App extends React.Component {\n  // ...\n  render() {\n    return (\n      &lt;div className=&quot;container&quot;&gt;\n        // ...\n      &lt;/div&gt;\n    )\n  }\n}</code></pre></div>\n<p>Sovelluksen ulkoasu muuttuu siten, että sisältö ei ole enää yhtä kiinni selaimen reunoissa:</p>\n<picture><img src=\"/static/c7e8beb2f708315545d1560cf80f6c8a/14be6/11.png\" srcset=\"/static/c7e8beb2f708315545d1560cf80f6c8a/4cce7/11.png 200w,\n/static/c7e8beb2f708315545d1560cf80f6c8a/bae5f/11.png 400w,\n/static/c7e8beb2f708315545d1560cf80f6c8a/14be6/11.png 800w,\n/static/c7e8beb2f708315545d1560cf80f6c8a/1b35a/11.png 1200w,\n/static/c7e8beb2f708315545d1560cf80f6c8a/8c3ef/11.png 1518w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Muutetaan seuraavaksi komponenttia <em>Notes</em> siten, että se renderöi muistiinpanojen listan <a href=\"https://getbootstrap.com/docs/4.0/content/tables/\">taulukkona</a>. React bootstrap tarjoaa valmiin komponentin <a href=\"https://react-bootstrap.github.io/components/table/\">Table</a>, joten CSS-luokan käyttöön ei ole tarvetta.</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">const Notes = ({notes}) =&gt; (\n  &lt;div&gt;\n    &lt;h2&gt;Notes&lt;/h2&gt;\n    &lt;Table striped&gt;\n      &lt;tbody&gt;\n        {notes.map(note=&gt;\n          &lt;tr key={note.id}&gt;\n            &lt;td&gt;\n              &lt;Link to={`/notes/${note.id}`}&gt;{note.content}&lt;/Link&gt;\n            &lt;/td&gt;\n            &lt;td&gt;\n              {note.user}\n            &lt;/td&gt;\n          &lt;/tr&gt;\n        )}\n      &lt;/tbody&gt;\n    &lt;/Table&gt;\n  &lt;/div&gt;\n)</code></pre></div>\n<p>Ulkoasu on varsin tyylikäs:</p>\n<picture><img src=\"/static/d5175aa09c6e0f57668bc371c0525185/14be6/12.png\" srcset=\"/static/d5175aa09c6e0f57668bc371c0525185/4cce7/12.png 200w,\n/static/d5175aa09c6e0f57668bc371c0525185/bae5f/12.png 400w,\n/static/d5175aa09c6e0f57668bc371c0525185/14be6/12.png 800w,\n/static/d5175aa09c6e0f57668bc371c0525185/1b35a/12.png 1200w,\n/static/d5175aa09c6e0f57668bc371c0525185/b2a8e/12.png 1522w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Huomaa, että koodissa käytettävät React bootstrapin komponentit täytyy importata, eli koodiin on lisättävä:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Table <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-bootstrap'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h4>Lomake</h4>\n<p>Parannellaan seuraavaksi näkymän <em>Login</em> kirjautumislomaketta Bootstrapin <a href=\"https://getbootstrap.com/docs/4.0/components/forms/\">lomakkeiden</a> avulla.</p>\n<p>React bootstrap tarjoaa valmiit <a href=\"https://react-bootstrap.github.io/components/forms/\">komponentit</a> myös lomakkeiden muodostamiseen (dokumentaatio tosin ei ole paras mahdollinen):</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">const Login = ({onLogin, history}) =&gt; {\n  // ...\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;login&lt;/h2&gt;\n      &lt;form onSubmit={onSubmit}&gt;\n        &lt;FormGroup&gt;\n          &lt;ControlLabel&gt;username:&lt;/ControlLabel&gt;\n          &lt;FormControl\n            type=&quot;text&quot;\n            name=&quot;username&quot;\n          /&gt;\n          &lt;ControlLabel&gt;password:&lt;/ControlLabel&gt;\n          &lt;FormControl\n            type=&quot;password&quot;\n          /&gt;\n          &lt;Button bsStyle=&quot;success&quot; type=&quot;submit&quot;&gt;login&lt;/Button&gt;\n        &lt;/FormGroup&gt;\n      &lt;/form&gt;\n    &lt;/div&gt;\n)}</code></pre></div>\n<p>Importoitavien komponenttien määrä kasvaa:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span>\n  Table<span class=\"token punctuation\">,</span>\n  FormGroup<span class=\"token punctuation\">,</span>\n  FormControl<span class=\"token punctuation\">,</span>\n  ControlLabel<span class=\"token punctuation\">,</span>\n  Button<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react-bootstrap'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Lomake näyttää parantelun jälkeen seuraavalta:</p>\n<picture><img src=\"/static/1cc551bb5de16a29ae9571e49bdd5a68/14be6/12b.png\" srcset=\"/static/1cc551bb5de16a29ae9571e49bdd5a68/4cce7/12b.png 200w,\n/static/1cc551bb5de16a29ae9571e49bdd5a68/bae5f/12b.png 400w,\n/static/1cc551bb5de16a29ae9571e49bdd5a68/14be6/12b.png 800w,\n/static/1cc551bb5de16a29ae9571e49bdd5a68/1b35a/12b.png 1200w,\n/static/1cc551bb5de16a29ae9571e49bdd5a68/8b923/12b.png 1572w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<h4>Notifikaatio</h4>\n<p>Toteutetaan sovellukseen kirjautumisen jälkeinen <em>notifikaatio</em>:</p>\n<picture><img src=\"/static/600dba48f9410ec48a8df6ec00dfd37f/14be6/13.png\" srcset=\"/static/600dba48f9410ec48a8df6ec00dfd37f/4cce7/13.png 200w,\n/static/600dba48f9410ec48a8df6ec00dfd37f/bae5f/13.png 400w,\n/static/600dba48f9410ec48a8df6ec00dfd37f/14be6/13.png 800w,\n/static/600dba48f9410ec48a8df6ec00dfd37f/1b35a/13.png 1200w,\n/static/600dba48f9410ec48a8df6ec00dfd37f/9ee03/13.png 1600w,\n/static/600dba48f9410ec48a8df6ec00dfd37f/a6552/13.png 1778w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Asetetaan notifikaatio kirjautumisen yhteydessä komponentin <em>App</em> tilan kenttään <em>message</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">login</span> <span class=\"token operator\">=</span> user <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> user<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`welcome </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>user<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> message<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ja renderöidään viesti Bootstrapin <a href=\"https://getbootstrap.com/docs/4.0/components/alerts/\">Alert</a>-komponentin avulla. React bootstrap tarjoaa tähän jälleen valmiin <a href=\"https://react-bootstrap.github.io/components/alerts/\">React-komponentin</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">{(this.state.message &amp;&amp;\n  &lt;Alert color=&quot;success&quot;&gt;\n    {this.state.message}\n  &lt;/Alert&gt;\n)}</code></pre></div>\n<h4>Navigaatiorakenne</h4>\n<p>Muutetaan vielä lopuksi sovelluksen navigaatiomenu käyttämään Bootstrapin <a href=\"https://getbootstrap.com/docs/4.0/components/navbar/\">Navbaria</a>. Tähänkin React bootstrap tarjoaa <a href=\"https://react-bootstrap.github.io/components/navbar/#navbars-mobile-friendly\">valmiit komponentit</a>, dokumentaatio on hieman kryptistä, mutta trial and error johtaa lopulta toimivaan ratkaisuun:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Navbar inverse collapseOnSelect<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Navbar.Header<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Navbar.Brand<span class=\"token operator\">></span>\n      Anecdote app\n    <span class=\"token operator\">&lt;</span>/Navbar.Brand<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Navbar.Toggle /<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>/Navbar.Header<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Navbar.Collapse<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Nav<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>NavItem href<span class=\"token operator\">=</span><span class=\"token string\">\"#\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span><span class=\"token operator\">></span>home<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>/NavItem<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>NavItem href<span class=\"token operator\">=</span><span class=\"token string\">\"#\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/notes\"</span><span class=\"token operator\">></span>notes<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>/NavItem<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>NavItem href<span class=\"token operator\">=</span><span class=\"token string\">\"#\"</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/users\"</span><span class=\"token operator\">></span>users<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>/NavItem<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>NavItem<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>this.state.user\n          ? <span class=\"token operator\">&lt;</span>em<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>this.state.user<span class=\"token punctuation\">}</span> logged in<span class=\"token operator\">&lt;</span>/em<span class=\"token operator\">></span>\n          <span class=\"token keyword\">:</span> <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/login\"</span><span class=\"token operator\">></span>login<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>/NavItem<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>/Nav<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>/Navbar.Collapse<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/Navbar<span class=\"token operator\">></span></code></pre></div>\n<p>Ulkoasu on varsin tyylikäs</p>\n<picture><img src=\"/static/696d1b1584cfe3f1d804e451f94b2071/14be6/14.png\" srcset=\"/static/696d1b1584cfe3f1d804e451f94b2071/4cce7/14.png 200w,\n/static/696d1b1584cfe3f1d804e451f94b2071/bae5f/14.png 400w,\n/static/696d1b1584cfe3f1d804e451f94b2071/14be6/14.png 800w,\n/static/696d1b1584cfe3f1d804e451f94b2071/1b35a/14.png 1200w,\n/static/696d1b1584cfe3f1d804e451f94b2071/9ee03/14.png 1600w,\n/static/696d1b1584cfe3f1d804e451f94b2071/9a091/14.png 1756w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Jos selaimen kokoa kaventaa, huomaamme että menu \"kollapsoituu\" ja sen saa näkyville vain klikkaamalla:</p>\n<picture><img src=\"/static/75e9480851bbe5c84f1483da328e72af/14be6/15.png\" srcset=\"/static/75e9480851bbe5c84f1483da328e72af/4cce7/15.png 200w,\n/static/75e9480851bbe5c84f1483da328e72af/bae5f/15.png 400w,\n/static/75e9480851bbe5c84f1483da328e72af/14be6/15.png 800w,\n/static/75e9480851bbe5c84f1483da328e72af/1b35a/15.png 1200w,\n/static/75e9480851bbe5c84f1483da328e72af/f5052/15.png 1476w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Bootstrap ja valtaosa tarjolla olevista UI-frameworkeista tuottavat <a href=\"https://en.wikipedia.org/wiki/Responsive_web_design\">responsiivisia</a> näkymiä, eli sellaisia jotka renderöityvät vähintään kohtuullisesti monen kokoisilla näytöillä.</p>\n<p>Chromen konsolin avulla on mahdollista simuloida sovelluksen käyttöä erilaisilla mobiilipäätteillä</p>\n<picture><img src=\"/static/1af080ec23cf2268f7ffd62979bb2996/14be6/16.png\" srcset=\"/static/1af080ec23cf2268f7ffd62979bb2996/4cce7/16.png 200w,\n/static/1af080ec23cf2268f7ffd62979bb2996/bae5f/16.png 400w,\n/static/1af080ec23cf2268f7ffd62979bb2996/14be6/16.png 800w,\n/static/1af080ec23cf2268f7ffd62979bb2996/1b35a/16.png 1200w,\n/static/1af080ec23cf2268f7ffd62979bb2996/9ee03/16.png 1600w,\n/static/1af080ec23cf2268f7ffd62979bb2996/72014/16.png 1690w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Sovellus toimii hyvin, mutta konsoliin vilkaisu paljastaa erään ikävän detaljin:</p>\n<picture><img src=\"/static/a780f2c5c127b477b0266ad4fc2f0cd0/14be6/17.png\" srcset=\"/static/a780f2c5c127b477b0266ad4fc2f0cd0/4cce7/17.png 200w,\n/static/a780f2c5c127b477b0266ad4fc2f0cd0/bae5f/17.png 400w,\n/static/a780f2c5c127b477b0266ad4fc2f0cd0/14be6/17.png 800w,\n/static/a780f2c5c127b477b0266ad4fc2f0cd0/1b35a/17.png 1200w,\n/static/a780f2c5c127b477b0266ad4fc2f0cd0/9ee03/17.png 1600w,\n/static/a780f2c5c127b477b0266ad4fc2f0cd0/a0ecf/17.png 1654w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Syy valituksiin on navigaatiorakenteessa</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>NavItem href<span class=\"token operator\">=</span><span class=\"token string\">\"#\"</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span><span class=\"token operator\">></span>home<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/NavItem<span class=\"token operator\">></span></code></pre></div>\n<p>Nämä sisäkkäiset komponentit sisältävät molemmat <em>a</em>-tagin ja React hermostuu tästä.</p>\n<p>Ongelma on ikävä ja sen kiertäminen on toki mahdollista, katso esim.\n<a href=\"https://serverless-stack.com/chapters/adding-links-in-the-navbar.html\">https://serverless-stack.com/chapters/adding-links-in-the-navbar.html</a></p>\n<p>Esimerkin sovelluksen koodi kokonaisuudessaan <a href=\"https://github.com/FullStack-HY/FullStack-Hy.github.io/wiki/bootstrap\">täällä</a>.</p>\n<h3>Semantic UI</h3>\n<p>Olen käyttänyt bootstrapia vuosia, mutta siirryin hiljattain <a href=\"https://semantic-ui.com/\">Semantic UI</a>:n käyttäjäksi. Kurssin tehtävien <a href=\"https://studies.cs.helsinki.fi/fs-stats\">palautusovellus</a> on tehty Semanticilla ja kokemukset ovat olleet rohkaisevia, erityisesti semanticin <a href=\"https://react.semantic-ui.com\">React-tuki</a> on ensiluokkainen ja dokumentaatiokin huomattavasti parempi kuin bootstrapissa.</p>\n<p>Lisätään nyt <a href=\"/osa6/#react-router\">React-router</a>-sovellukselle edellisen luvun tapaan tyylit semanticilla.</p>\n<p>Aloitetaan asentamalla <a href=\"https://react.semantic-ui.com\">semantic-ui-react</a>-kirjasto:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save semantic-ui-react</code></pre></div>\n<p>Lisätään sitten sovelluksen tiedostoon <em>public/index.html</em> head-tagin sisään semanticin css-määrittelyt lataava rivi (joka löytyy <a href=\"https://react.semantic-ui.com/usage#content-delivery-network-cdn\">tästä</a>):</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>head</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>link</span> <span class=\"token attr-name\">rel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>stylesheet<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">href</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>//cdnjs.cloudflare.com/ajax/libs/semantic-ui/2.2.12/semantic.min.css<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>link</span><span class=\"token punctuation\">></span></span>\n  // ...\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>head</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Sijoitetaan koko sovelluksen renderöimä sisältö Semanticin komponentin <a href=\"https://react.semantic-ui.com/elements/container\">Container</a> sisälle.</p>\n<p>Semanticin dokumentaatio sisältää jokaisesta komponentista useita esimerkkikoodinpätkiä, joiden avulla komponenttien käytön periaatteet on helppo omaksua:</p>\n<picture><img src=\"/static/b9e6e01b48699a864c31b3a70af7ce71/14be6/18.png\" srcset=\"/static/b9e6e01b48699a864c31b3a70af7ce71/4cce7/18.png 200w,\n/static/b9e6e01b48699a864c31b3a70af7ce71/bae5f/18.png 400w,\n/static/b9e6e01b48699a864c31b3a70af7ce71/14be6/18.png 800w,\n/static/b9e6e01b48699a864c31b3a70af7ce71/1b35a/18.png 1200w,\n/static/b9e6e01b48699a864c31b3a70af7ce71/9ee03/18.png 1600w,\n/static/b9e6e01b48699a864c31b3a70af7ce71/c09de/18.png 1740w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Muutetaan komponentin App uloin <em>div</em>-elementti <em>Containeriksi</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">import</span> <span class=\"token punctuation\">{</span> Container <span class=\"token punctuation\">}</span> from <span class=\"token string\">'semantic-ui-react'</span>\n\n// <span class=\"token punctuation\">..</span>.\n\nclass App extends React.Component <span class=\"token punctuation\">{</span>\n  // <span class=\"token punctuation\">..</span>.\n  render<span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>Container<span class=\"token operator\">></span>\n        // <span class=\"token punctuation\">..</span>.\n      <span class=\"token operator\">&lt;</span>/Container<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Sivun sisältö ei ole enää reunoissa kiinni:</p>\n<picture><img src=\"/static/8e375f968b5bc220820e8151bce8fa4d/14be6/19.png\" srcset=\"/static/8e375f968b5bc220820e8151bce8fa4d/4cce7/19.png 200w,\n/static/8e375f968b5bc220820e8151bce8fa4d/bae5f/19.png 400w,\n/static/8e375f968b5bc220820e8151bce8fa4d/14be6/19.png 800w,\n/static/8e375f968b5bc220820e8151bce8fa4d/1b35a/19.png 1200w,\n/static/8e375f968b5bc220820e8151bce8fa4d/9ee03/19.png 1600w,\n/static/8e375f968b5bc220820e8151bce8fa4d/06ff7/19.png 1630w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Edellisen luvun tapaan, renderöidään muistiinpanot taulukkona, komponentin <a href=\"https://react.semantic-ui.com/collections/table\">Table</a> avulla. Koodi näyttää seuraavalta</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">import { Table } from &#39;semantic-ui-react&#39;\n\nconst Notes = ({ notes }) =&gt; (\n  &lt;div&gt;\n    &lt;h2&gt;Notes&lt;/h2&gt;\n    &lt;Table striped celled&gt;\n      &lt;Table.Body&gt;\n        {notes.map(note =&gt;\n          &lt;Table.Row key={note.id}&gt;\n            &lt;Table.Cell&gt;\n              &lt;Link to={`/notes/${note.id}`}&gt;{note.content}&lt;/Link&gt;\n            &lt;/Table.Cell&gt;\n            &lt;Table.Cell&gt;\n              {note.user}\n            &lt;/Table.Cell&gt;\n          &lt;/Table.Row&gt;\n        )}\n      &lt;/Table.Body&gt;\n    &lt;/Table&gt;\n  &lt;/div&gt;\n)</code></pre></div>\n<p>Muistiinpanojen lista näyttää seuraavalta:</p>\n<picture><img src=\"/static/d0606c506c403790adfc0de9f42a67ec/14be6/20.png\" srcset=\"/static/d0606c506c403790adfc0de9f42a67ec/4cce7/20.png 200w,\n/static/d0606c506c403790adfc0de9f42a67ec/bae5f/20.png 400w,\n/static/d0606c506c403790adfc0de9f42a67ec/14be6/20.png 800w,\n/static/d0606c506c403790adfc0de9f42a67ec/1b35a/20.png 1200w,\n/static/d0606c506c403790adfc0de9f42a67ec/9ee03/20.png 1600w,\n/static/d0606c506c403790adfc0de9f42a67ec/0c0a3/20.png 1624w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<h4>Lomake</h4>\n<p>Otetaan kirjautumissivulla käyttöön Semanticin <a href=\"https://react.semantic-ui.com/collections/form\">Form</a>-komponentti:</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">import { Form, Button } from &#39;semantic-ui-react&#39;\n\nconst Login = ({ onLogin, history }) =&gt; {\n  const onSubmit = (event) =&gt; {\n    // ...\n  }\n  return (\n    &lt;div&gt;\n      &lt;h2&gt;login&lt;/h2&gt;\n      &lt;Form onSubmit={onSubmit}&gt;\n        &lt;Form.Field&gt;\n          &lt;label&gt;username&lt;/label&gt;\n          &lt;input name=&#39;username&#39; /&gt;\n        &lt;/Form.Field&gt;\n        &lt;Form.Field&gt;\n          &lt;label&gt;password&lt;/label&gt;\n          &lt;input type=&#39;password&#39; /&gt;\n        &lt;/Form.Field&gt;\n        &lt;Button type=&#39;submit&#39;&gt;login&lt;/Button&gt;\n      &lt;/Form&gt;\n    &lt;/div&gt;\n  )\n}</code></pre></div>\n<p>Ulkoasu näyttää seuraavalta:</p>\n<picture><img src=\"/static/d48b0e0c1325bf6e19c3ddc6e70419d0/14be6/21.png\" srcset=\"/static/d48b0e0c1325bf6e19c3ddc6e70419d0/4cce7/21.png 200w,\n/static/d48b0e0c1325bf6e19c3ddc6e70419d0/bae5f/21.png 400w,\n/static/d48b0e0c1325bf6e19c3ddc6e70419d0/14be6/21.png 800w,\n/static/d48b0e0c1325bf6e19c3ddc6e70419d0/1b35a/21.png 1200w,\n/static/d48b0e0c1325bf6e19c3ddc6e70419d0/b4b8e/21.png 1380w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<h4>Notifikaatio</h4>\n<p>Edellisen luvun tapaan, toteutetaan sovellukseen kirjautumisen jälkeinen <em>notifikaatio</em>:</p>\n<picture><img src=\"/static/7ee600a5c64170469543b2a9d7fc7e5d/14be6/22.png\" srcset=\"/static/7ee600a5c64170469543b2a9d7fc7e5d/4cce7/22.png 200w,\n/static/7ee600a5c64170469543b2a9d7fc7e5d/bae5f/22.png 400w,\n/static/7ee600a5c64170469543b2a9d7fc7e5d/14be6/22.png 800w,\n/static/7ee600a5c64170469543b2a9d7fc7e5d/1b35a/22.png 1200w,\n/static/7ee600a5c64170469543b2a9d7fc7e5d/f5052/22.png 1476w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Kuten edellisessä luvussa, asetetaan notifikaatio kirjautumisen yhteydessä komponentin <em>App</em> tilan kenttään <em>message</em>:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">login</span> <span class=\"token operator\">=</span> user <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> user<span class=\"token punctuation\">,</span> message<span class=\"token punctuation\">:</span> <span class=\"token template-string\"><span class=\"token string\">`welcome </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>user<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\">`</span></span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token function\">setTimeout</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> message<span class=\"token punctuation\">:</span> <span class=\"token keyword\">null</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token number\">10000</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ja renderöidään viesti käyttäen komponenttia <a href=\"https://react.semantic-ui.com/collections/message\">Message</a>:</p>\n<div class=\"gatsby-highlight\" data-language=\"react\"><pre class=\"language-react\"><code class=\"language-react\">{(this.state.message &amp;&amp;\n  &lt;Message success&gt;\n    {this.state.message}\n  &lt;/Message&gt;\n)}</code></pre></div>\n<h4>Navigaatiorakenne</h4>\n<p>Navigaatiorakenne toteutetaan komponentin <a href=\"https://react.semantic-ui.com/collections/menu\">Menu</a> avulla:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Menu inverted<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Menu.Item link<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/\"</span><span class=\"token operator\">></span>home<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>/Menu.Item<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Menu.Item link<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/notes\"</span><span class=\"token operator\">></span>notes<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>/Menu.Item<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Menu.Item link<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/users\"</span><span class=\"token operator\">></span>users<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>/Menu.Item<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Menu.Item link<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">{</span>this.state.user\n      ? <span class=\"token operator\">&lt;</span>em<span class=\"token operator\">></span><span class=\"token punctuation\">{</span>this.state.user<span class=\"token punctuation\">}</span> logged in<span class=\"token operator\">&lt;</span>/em<span class=\"token operator\">></span>\n      <span class=\"token keyword\">:</span> <span class=\"token operator\">&lt;</span>Link to<span class=\"token operator\">=</span><span class=\"token string\">\"/login\"</span><span class=\"token operator\">></span>login<span class=\"token operator\">&lt;</span>/Link<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">&lt;</span>/Menu.Item<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/Menu<span class=\"token operator\">></span></code></pre></div>\n<p>Lopputulos näyttää seuraavalta:</p>\n<picture><img src=\"/static/4d9567f0b1d250dacb099d30d764db21/14be6/23.png\" srcset=\"/static/4d9567f0b1d250dacb099d30d764db21/4cce7/23.png 200w,\n/static/4d9567f0b1d250dacb099d30d764db21/bae5f/23.png 400w,\n/static/4d9567f0b1d250dacb099d30d764db21/14be6/23.png 800w,\n/static/4d9567f0b1d250dacb099d30d764db21/1b35a/23.png 1200w,\n/static/4d9567f0b1d250dacb099d30d764db21/9ee03/23.png 1600w,\n/static/4d9567f0b1d250dacb099d30d764db21/beddc/23.png 1610w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Bootstrapin yhteydessä esiintynyttä sisäkkäisen <em>a</em>-tagien ongelmaa ei semanticin kanssa ole.</p>\n<p>Esimerkin sovelluksen koodi kokonaisuudessaan <a href=\"https://github.com/FullStack-HY/FullStack-Hy.github.io/wiki/semantic-ui\">täällä</a>.</p>\n<h3>Loppuhuomioita</h3>\n<p>Ero react-bootstrapin ja semantic-ui-reactin välillä ei ole suuri. On makuasia kummalla tuotettu ulkoasu on tyylikkäämpi. Oma vuosia kestäneen bootstrapin käytön jälkeinen siirtymiseni semanticiin johtuu semanticin saumattomammasta React-tuesta, laajemmasta valmiiden komponenttien valikoimasta ja paremmasta sekä selkeämmästä dokumentaatiosta. Semantic UI projektin kehitystyön jatkuvuuden suhteen on kuitenkin viime aikoina ollut ilmoilla muutamia <a href=\"https://github.com/Semantic-Org/Semantic-UI/issues/6109\">kysymysmerkkejä</a>, ja tilannetta kannattaakin seurata.</p>\n<p>Esimerkissä käytettiin UI-frameworkeja niiden React-integraatiot tarjoavien kirjastojen kautta.</p>\n<p>Sen sijaan että käytimme kirjastoa <a href=\"https://react-bootstrap.github.io/\">React bootstrap</a>, olisimme voineet aivan yhtä hyvin käyttää Bootstrapia suoraan, liittämällä HTML-elementteihin CSS-luokkia. Eli sen sijaan että määrittelimme esim. taulukon komponentin <em>Table</em> avulla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>Table striped<span class=\"token operator\">></span>\n  // <span class=\"token punctuation\">..</span>.\n<span class=\"token operator\">&lt;</span>/Table<span class=\"token operator\">></span></code></pre></div>\n<p>olisimme voineet käyttää normaalia HTML:n taulukkoa <em>table</em> ja CSS-luokkaa</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>table className<span class=\"token operator\">=</span><span class=\"token string\">\"table striped\"</span><span class=\"token operator\">></span>\n  // <span class=\"token punctuation\">..</span>.\n<span class=\"token operator\">&lt;</span>/table<span class=\"token operator\">></span></code></pre></div>\n<p>Taulukon määrittelyssä React bootstrapin tuoma etu ei ole suuri.</p>\n<p>Tiiviimmän ja ehkä paremmin luettavissa olevan kirjoitusasun lisäksi toinen etu React-kirjastoina olevissa UI-frameworkeissa on se, että kirjastojen mahdollisesti käyttämä Javascript-koodi on sisällytetty React-komponentteihin. Esim. osa Bootstrapin komponenteista edellyttää toimiakseen muutamaakin ikävää <a href=\"https://getbootstrap.com/docs/4.0/getting-started/introduction/#js\">Javascript-riippuvuutta</a> joita emme mielellään halua React-sovelluksiin sisällyttää.</p>\n<p>React-kirjastoina tarjottavien UI-frameworkkien ikävä puoli verrattuna frameworkin \"suoraan käyttöön\" on React-kirjastojen API:n mahdollinen epästabiilius ja osittain huono dokumentaatio. Tosin <a href=\"https://react.semantic-ui.com\">react-semanticin</a> suhteen tilanne on paljon parempi kuin monien muiden UI-frameworkien sillä kyseessä on virallinen React-integraatio.</p>\n<p>Kokonaan toinen kysymys on se kannattaako UI-frameworkkeja ylipäätän käyttää. Kukin muodostakoon oman mielipiteensä, mutta CSS:ää taitamattomalle ja puutteellisilla design-taidoilla varustetulle ne ovat varsin käyttökelpoisia työkaluja.</p>\n<h3>Muita UI-frameworkeja</h3>\n<p>Luetellaan tässä kaikesta huolimatta muitakin UI-frameworkeja. Jos oma suosikkisi ei ole mukana, tee pull request</p>\n<ul>\n<li><a href=\"http://www.material-ui.com/\">http://www.material-ui.com/</a></li>\n<li><a href=\"https://bulma.io/\">https://bulma.io/</a></li>\n<li><a href=\"https://ant.design/\">https://ant.design/</a></li>\n<li><a href=\"https://foundation.zurb.com/\">https://foundation.zurb.com/</a></li>\n</ul>\n<p>Alun perin tässä osassa oli tarkoitus käyttää <a href=\"http://www.material-ui.com/\">Material UI</a>:ta, mutta kirjasto on juuri nyt kiivaan kehityksen alla ennen version 1.0 julkaisemista ja osa dokumentaation esimerkeistä ei toiminut uusimmalla versiolla. Voikin olla viisainta odotella Materialin kanssa versiota 1.0.</p>\n<h2>Tehtäviä</h2>\n<p>Tee nyt tehtävät <a href=\"/teht%C3%A4v%C3%A4t#ui-framework\">6.21-6.23</a></p>\n</div>","frontmatter":{"mainImage":{"publicURL":"/static/part-6-d6924a30e54668b01a539aa7bc2db9e8.svg"},"part":6,"letter":"b"}}},"pageContext":{"part":6,"letter":"b"}}