{"data":{"markdownRemark":{"html":"<div class=\"content\">\n<h3>Kirjautumislomakkeen näyttäminen vain tarvittaessa</h3>\n<p>Muutetaan sovellusta siten, että kirjautumislomaketta ei oletusarvoisesti näytetä:</p>\n<picture><img src=\"/static/d80281d9b4145460638bd90d693d1a8a/14be6/3.png\" srcset=\"/static/d80281d9b4145460638bd90d693d1a8a/4cce7/3.png 200w,\n/static/d80281d9b4145460638bd90d693d1a8a/bae5f/3.png 400w,\n/static/d80281d9b4145460638bd90d693d1a8a/14be6/3.png 800w,\n/static/d80281d9b4145460638bd90d693d1a8a/1b35a/3.png 1200w,\n/static/d80281d9b4145460638bd90d693d1a8a/9ee03/3.png 1600w,\n/static/d80281d9b4145460638bd90d693d1a8a/00da9/3.png 1672w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Lomake aukeaa, jos käyttäjä painaa nappia <i>login</i>:</p>\n<picture><img src=\"/static/965f241a142c0bc26a29df36c0b7ecc7/14be6/4.png\" srcset=\"/static/965f241a142c0bc26a29df36c0b7ecc7/4cce7/4.png 200w,\n/static/965f241a142c0bc26a29df36c0b7ecc7/bae5f/4.png 400w,\n/static/965f241a142c0bc26a29df36c0b7ecc7/14be6/4.png 800w,\n/static/965f241a142c0bc26a29df36c0b7ecc7/1b35a/4.png 1200w,\n/static/965f241a142c0bc26a29df36c0b7ecc7/c6ea5/4.png 1506w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Napilla <em>cancel</em> käyttäjä saa tarvittaessa suljettua lomakkeen.</p>\n<p>Aloitetaan eristämällä kirjautumislomake omaksi komponentikseen:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">const LoginForm = ({ handleSubmit, handleChange, username, password }) => {\nreturn (\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>h2</span><span class=\"token punctuation\">></span></span>Kirjaudu<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>h2</span><span class=\"token punctuation\">></span></span>\n\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onSubmit</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{handleSubmit}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n      käyttäjätunnus\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span> <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{username}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">onChange</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{handleChange}<span class=\"token punctuation\">\"</span></span> <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>username<span class=\"token punctuation\">\"</span></span> <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n      salasana\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n        <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>password<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{password}<span class=\"token punctuation\">\"</span></span>\n        <span class=\"token attr-name\">onChange</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{handleChange}<span class=\"token punctuation\">\"</span></span>\n      <span class=\"token punctuation\">/></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>kirjaudu<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n) }</code></pre></div>\n<p>Reactin <a href=\"https://reactjs.org/docs/lifting-state-up.html\">suosittelemaan tyyliin</a> tila ja tilaa käsittelevät funktiot on kaikki määritelty komponentin ulkopuolella ja välitetään komponentille propseina.</p>\n<p>Huomaa, että propsit otetaan vastaan <em>destrukturoimalla</em>, eli sen sijaan että määriteltäisiin</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">const LoginForm = (props) => {\n  return (\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>form</span> <span class=\"token attr-name\">onSubmit</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{props.handleSubmit}</span><span class=\"token punctuation\">></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token punctuation\">></span></span>\n          käyttäjätunnus\n          <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>input</span>\n            <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{props.username}</span>\n            <span class=\"token attr-name\">onChange</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{props.handleChange}</span>\n            <span class=\"token attr-name\">name</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>username<span class=\"token punctuation\">\"</span></span>\n          <span class=\"token punctuation\">/></span></span>\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n        // ...\n        <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">type</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>submit<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>kirjaudu<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>form</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n  )\n}</code></pre></div>\n<p>jolloin muuttujan <em>props</em> kenttiin on viitattava muuttujan kautta esim. <em>props.handleSubmit</em>, otetaan kentät suoraan vastaan omiin muuttujiinsa.</p>\n<p>Nopea tapa toiminnallisuuden toteuttamiseen on muuttaa komponentin <em>App</em> käyttämä funktio <em>loginForm</em> seuraavaan muotoon:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">loginForm</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> hideWhenVisible <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> display<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>loginVisible <span class=\"token operator\">?</span> <span class=\"token string\">'none'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">''</span> <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">const</span> showWhenVisible <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> display<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>loginVisible <span class=\"token operator\">?</span> <span class=\"token string\">''</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'none'</span> <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>hideWhenVisible<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>e <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> loginVisible<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>log <span class=\"token keyword\">in</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>showWhenVisible<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>LoginForm\n          username<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>username<span class=\"token punctuation\">}</span>\n          password<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>password<span class=\"token punctuation\">}</span>\n          handleChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleLoginFieldChange<span class=\"token punctuation\">}</span>\n          handleSubmit<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>login<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>e <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> loginVisible<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>cancel<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Komponentin <em>App</em> tilaan on nyt lisätty kenttä <em>loginVisible</em> joka määrittelee sen näytetäänkö kirjautumislomake.</p>\n<p>Näkyvyyttä säätelevää tilaa vaihdellaan kahden napin avulla, molempiin on kirjoitettu tapahtumankäsittelijän koodi suoraan:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>e <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> loginVisible<span class=\"token punctuation\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>log <span class=\"token keyword\">in</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n\n<span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>e <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> loginVisible<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>cancel<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span></code></pre></div>\n<p>Komponenttien näkyvyys on määritelty asettamalla komponentille CSS-määrittely, jossa <a href=\"https://developer.mozilla.org/en-US/docs/Web/CSS/display\">display</a>-propertyn arvoksi asetetaan <em>none</em> jos komponentin ei haluta näkyvän:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\">const hideWhenVisible = { display: this.state.loginVisible ? 'none' : '' } const\nshowWhenVisible = { display: this.state.loginVisible ? '' : 'none' } // ...\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token punctuation\">{</span>hideWhenVisible<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>// nappi<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span>\n\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token punctuation\">{</span>showWhenVisible<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>// lomake<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Käytössä on taas kysymysmerkkioperaattori, eli jos <em>this.state.loginVisible</em> on <em>true</em>, tulee napin CSS-määrittelyksi</p>\n<div class=\"gatsby-highlight\" data-language=\"css\"><pre class=\"language-css\"><code class=\"language-css\"><span class=\"token property\">display</span><span class=\"token punctuation\">:</span> <span class=\"token string\">'none'</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>jos <em>this.state.loginVisible</em> on <em>false</em>, ei <em>display</em> saa mitään (napin näkyvyyteen liittyvää) arvoa.</p>\n<p>Hyödynsimme mahdollisuutta määritellä React-komponenteille koodin avulla <a href=\"https://react-cn.github.io/react/tips/inline-styles.html\">inline</a>-tyylejä. Palaamme asiaan tarkemmin seuraavassa osassa.</p>\n<h3>Komponentin lapset, eli this.props.children</h3>\n<p>Kirjautumislomakkeen näkyvyyttä ympäröivän koodin voi ajatella olevan oma looginen kokonaisuutensa ja se onkin hyvä eristää pois komponentista <em>App</em> omaksi komponentikseen.</p>\n<p>Tavoitteena on luoda komponentti <em>Togglable</em>, jota käytetään seuraavalla tavalla:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Togglable</span> <span class=\"token attr-name\">buttonLabel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>login<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>LoginForm</span>\n    <span class=\"token attr-name\">username</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{this.state.username}</span>\n    <span class=\"token attr-name\">password</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{this.state.password}</span>\n    <span class=\"token attr-name\">handleChange</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{this.handleLoginFieldChange}</span>\n    <span class=\"token attr-name\">handleSubmit</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{this.login}</span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Togglable</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Komponentin käyttö poikkeaa aiemmin näkemistämme siinä, että käytössä on nyt avaava ja sulkeva tagi, joiden sisällä määritellään toinen komponentti eli <em>LoginForm</em>. Reactin terminologiassa <em>LoginForm</em> on nyt komponentin <em>Togglable</em> lapsi.</p>\n<p><em>Togglablen</em> avaavan ja sulkevan tagin sisälle voi sijoittaa lapsiksi mitä tahansa React-elementtejä, esim.:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Togglable</span> <span class=\"token attr-name\">buttonLabel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>paljasta<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>tämä on aluksi piilossa<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>p</span><span class=\"token punctuation\">></span></span>toinen salainen rivi<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>p</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Togglable</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Komponentin koodi on seuraavassa:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Togglable</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span>props<span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      visible<span class=\"token punctuation\">:</span> <span class=\"token boolean\">false</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function-variable function\">toggleVisibility</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>visible<span class=\"token punctuation\">:</span> <span class=\"token operator\">!</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>visible<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> hideWhenVisible <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> display<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>visible <span class=\"token operator\">?</span> <span class=\"token string\">'none'</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">''</span> <span class=\"token punctuation\">}</span>\n    <span class=\"token keyword\">const</span> showWhenVisible <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> display<span class=\"token punctuation\">:</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>visible <span class=\"token operator\">?</span> <span class=\"token string\">''</span> <span class=\"token punctuation\">:</span> <span class=\"token string\">'none'</span> <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>hideWhenVisible<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggleVisibility<span class=\"token punctuation\">}</span><span class=\"token operator\">></span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>buttonLabel<span class=\"token punctuation\">}</span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>div style<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>showWhenVisible<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>children<span class=\"token punctuation\">}</span>\n          <span class=\"token operator\">&lt;</span>button onClick<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>toggleVisibility<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>cancel<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Mielenkiintoista ja meille uutta on <a href=\"https://reactjs.org/docs/glossary.html#propschildren\">this.props.children</a>, jonka avulla koodi viittaa komponentin lapsiin, eli avaavan ja sulkevan tagin sisällä määriteltyihin React-elementteihin.</p>\n<p>Tällä kertaa lapset ainoastaan renderöidään komponentin oman renderöivän koodin seassa:</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>div</span><span class=\"token style-attr language-css\"><span class=\"token attr-name\"> <span class=\"token attr-name\">style</span></span><span class=\"token punctuation\">=\"</span><span class=\"token attr-value\"><span class=\"token punctuation\">{</span>showWhenVisible<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  {this.props.children}\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>{this.toggleVisibility}<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>cancel<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>div</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Toisin kuin \"normaalit\" propsit, <em>children</em> on Reactin automaattisesti määrittelemä, aina olemassa oleva propsi. Jos komponentti määritellään automaattisesti suljettavalla eli <em>/></em> loppuvalla tagilla, esim.</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Note</span>\n  <span class=\"token attr-name\">key</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{note.id}</span>\n  <span class=\"token attr-name\">note</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{note}</span>\n  <span class=\"token attr-name\">toggleImportance</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{this.toggleImportanceOf(note.id)}</span>\n<span class=\"token punctuation\">/></span></span></code></pre></div>\n<p>on <em>this.props.children</em> tyhjä taulukko.</p>\n<p>Komponentti <em>Togglable</em> on uusiokäytettävä ja voimme käyttää sitä tekemään myös uuden muistiinpanon luomisesta huolehtivan formin vastaavalla tavalla tarpeen mukaan näytettäväksi.</p>\n<p>Eristetään ensin muistiinpanojen luominen omaksi komponentiksi</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> <span class=\"token function-variable function\">NoteForm</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> onSubmit<span class=\"token punctuation\">,</span> handleChange<span class=\"token punctuation\">,</span> value<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>h2<span class=\"token operator\">></span>Luo uusi muistiinpano<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h2<span class=\"token operator\">></span>\n\n      <span class=\"token operator\">&lt;</span>form onSubmit<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>onSubmit<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>input\n          value<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>value<span class=\"token punctuation\">}</span>\n          onChange<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleChange<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">/</span><span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>button type<span class=\"token operator\">=</span><span class=\"token string\">\"submit\"</span><span class=\"token operator\">></span>tallenna<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>button<span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>form<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ja määritellään lomakkeen näyttävä koodi komponentin <em>Togglable</em> sisällä</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Togglable</span> <span class=\"token attr-name\">buttonLabel</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span><span class=\"token punctuation\">\"</span>new note<span class=\"token punctuation\">\"</span></span><span class=\"token punctuation\">></span></span>\n  <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>NoteForm</span>\n    <span class=\"token attr-name\">onSubmit</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{this.addNote}</span>\n    <span class=\"token attr-name\">value</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{this.state.newNote}</span>\n    <span class=\"token attr-name\">handleChange</span><span class=\"token attr-value\"><span class=\"token punctuation\">=</span>{this.handleNoteChange}</span>\n  <span class=\"token punctuation\">/></span></span>\n<span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Togglable</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<h3>ref eli viite komponenttiin</h3>\n<p>Ratkaisu on melko hyvä, haluaisimme kuitenkin parantaa sitä erään seikan osalta.</p>\n<p>Kun uusi muistiinpano luodaan, olisi loogista jos luomislomake menisi piiloon. Nyt lomake pysyy näkyvillä. Lomakkeen piilottamiseen sisältyy kuitenkin pieni ongelma, sillä näkyvyyttä kontrolloidaan <em>Togglable</em>-komponentin tilassa olevalla muuttujalla ja komponentissa määritellyllä metodilla <em>toggleVisibility</em>. Miten pääsemme niihin käsiksi komponentin ulkopuolelta?</p>\n<p>Koska React-komponentit ovat Javascript-olioita, on niiden metodeja mahdollista kutsua jos komponenttia vastaavaan olioon onnistutaan saamaan viite.</p>\n<p>Eräs keino viitteen saamiseen on React-komponenttien attribuutti <a href=\"https://reactjs.org/docs/refs-and-the-dom.html#adding-a-ref-to-a-class-component\">ref</a>.</p>\n<p>Muutetaan lomakkeen renderöivää koodia seuraavasti:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Togglable buttonLabel<span class=\"token operator\">=</span><span class=\"token string\">\"new note\"</span> ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>component <span class=\"token operator\">=</span><span class=\"token operator\">></span> this.noteForm <span class=\"token operator\">=</span> component<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>NoteForm\n      <span class=\"token punctuation\">..</span>.\n    /<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>/Togglable<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span>/div<span class=\"token operator\">></span></code></pre></div>\n<p>Kun komponentti <em>Togglable</em> renderöidään, suorittaa React ref-attribuutin sisällä määritellyn funktion:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">component <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>noteForm <span class=\"token operator\">=</span> component<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>parametrin <em>component</em> arvona on viite komponenttiin. Funktio tallettaa viitteen muuttujaan <em>this.noteForm</em> eli <em>App</em>-komponentin kenttään <em>noteForm</em>.</p>\n<p>Nyt mistä tahansa komponentin <em>App</em> sisältä on mahdollista päästä käsiksi uusien muistiinpanojen luomisen sisältävään <em>Togglable</em>-komponenttiin.</p>\n<p>Voimme nyt piilottaa lomakkeen kutsumalla <em>this.noteForm.toggleVisibility()</em> samalla kun uuden muistiinpanon luominen tapahtuu:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function-variable function\">addNote</span> <span class=\"token operator\">=</span> e <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  e<span class=\"token punctuation\">.</span><span class=\"token function\">preventDefault</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>noteForm<span class=\"token punctuation\">.</span><span class=\"token function\">toggleVisibility</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token comment\">// ..</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Refeille on myös <a href=\"https://reactjs.org/docs/refs-and-the-dom.html\">muita käyttötarkoituksia</a> kuin React-komponentteihin käsiksi pääseminen.</p>\n<p>Sovelluksen tämänhetkinen koodi on kokonaisuudessaan <a href=\"https://github.com/fullstack-hy2019part2-notes/tree/part5-4\">githubissa</a>, tagissa <em>part5-4</em>.</p>\n<h3>Huomio komponenteista</h3>\n<p>Kun Reactissa määritellään komponentti</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Togglable</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>ja otetaan se käyttöön seuraavasti</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span>Togglable buttonLabel<span class=\"token operator\">=</span><span class=\"token string\">\"1\"</span> ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>component <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>t1 <span class=\"token operator\">=</span> component<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    ensimmäinen\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Togglable<span class=\"token operator\">></span>\n\n  <span class=\"token operator\">&lt;</span>Togglable buttonLabel<span class=\"token operator\">=</span><span class=\"token string\">\"2\"</span> ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>component <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>t2 <span class=\"token operator\">=</span> component<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    toinen\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Togglable<span class=\"token operator\">></span>\n\n  <span class=\"token operator\">&lt;</span>Togglable buttonLabel<span class=\"token operator\">=</span><span class=\"token string\">\"3\"</span> ref<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>component <span class=\"token operator\">=></span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>t3 <span class=\"token operator\">=</span> component<span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    kolmas\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Togglable<span class=\"token operator\">></span>\n<span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span></code></pre></div>\n<p>syntyy <em>kolme erillistä komponenttiolioa</em>, joilla on kaikilla oma tilansa:</p>\n<picture><img src=\"/static/374425db96cf74f0606366ba4f6fcab3/14be6/5.png\" srcset=\"/static/374425db96cf74f0606366ba4f6fcab3/4cce7/5.png 200w,\n/static/374425db96cf74f0606366ba4f6fcab3/bae5f/5.png 400w,\n/static/374425db96cf74f0606366ba4f6fcab3/14be6/5.png 800w,\n/static/374425db96cf74f0606366ba4f6fcab3/1b35a/5.png 1200w,\n/static/374425db96cf74f0606366ba4f6fcab3/9ee03/5.png 1600w,\n/static/374425db96cf74f0606366ba4f6fcab3/8cea1/5.png 1878w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p><em>ref</em>-attribuutin avulla on talletettu viite jokaiseen komponenttiin muuttujiin <em>this.t1</em>, <em>this.t2</em> ja <em>this.t3</em>.</p>\n<h3>Tehtäviä</h3>\n<p>Tee nyt tehtävät <a href=\"/teht%C3%A4v%C3%A4t#komponenttien-n%C3%A4ytt%C3%A4minen-vain-tarvittaessa\">5.5-5.10</a></p>\n<h3>PropTypes</h3>\n<p>Komponentti <em>Togglable</em> olettaa, että sille määritellään propsina <em>buttonLabel</em> napin teksti. Jos määrittely unohtuu</p>\n<div class=\"gatsby-highlight\" data-language=\"html\"><pre class=\"language-html\"><code class=\"language-html\"><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>Togglable</span><span class=\"token punctuation\">></span></span> buttonLabel unohtui... <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>Togglable</span><span class=\"token punctuation\">></span></span></code></pre></div>\n<p>Sovellus kyllä toimii, mutta selaimeen renderöityy hämäävästi nappi, jolla ei ole mitään tekstiä.</p>\n<p>Haluaisimmekin varmistaa että jos <em>Togglable</em>-komponenttia käytetään, on propsille \"pakko\" antaa arvo.</p>\n<p>Kirjaston olettamat ja edellyttämät propsit ja niiden tyypit voidaan määritellä kirjaston <a href=\"https://github.com/facebook/prop-types\">prop-types</a> avulla. Asennetaan kirjasto</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> --save prop-types</code></pre></div>\n<p><em>buttonLabel</em> voidaan määritellä <em>pakolliseksi</em> string-tyyppiseksi propsiksi seuraavasti</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Togglable</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span>\n\nTogglable<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  buttonLabel<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">.</span>isRequired\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Jos propsia ei määritellä, seurauksena on konsoliin tulostuva virheilmoitus</p>\n<picture><img src=\"/static/41bb47a3ccd900b75691f688da28ae70/14be6/6.png\" srcset=\"/static/41bb47a3ccd900b75691f688da28ae70/4cce7/6.png 200w,\n/static/41bb47a3ccd900b75691f688da28ae70/bae5f/6.png 400w,\n/static/41bb47a3ccd900b75691f688da28ae70/14be6/6.png 800w,\n/static/41bb47a3ccd900b75691f688da28ae70/1b35a/6.png 1200w,\n/static/41bb47a3ccd900b75691f688da28ae70/9ee03/6.png 1600w,\n/static/41bb47a3ccd900b75691f688da28ae70/fa017/6.png 1692w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Koodi kuitenkin toimii edelleen, eli mikään ei pakota määrittelemään propseja PropTypes-määrittelyistä huolimatta. On kuitenkin erittäin epäprofessionaalia jättää konsoliin <em>mitään</em> punaisia tulosteita.</p>\n<p>Määritellään Proptypet myös <em>LoginForm</em>-komponentille:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">LoginForm</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> handleSubmit<span class=\"token punctuation\">,</span> handleChange<span class=\"token punctuation\">,</span> username<span class=\"token punctuation\">,</span> password <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token comment\">// ...</span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n\nLoginForm<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  handleSubmit<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>func<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n  handleChange<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>func<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n  username<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n  password<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">.</span>isRequired\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Funktionaalisen komponentin proptypejen määrittely tapahtuu samalla tavalla kuin luokkaperustaisten.</p>\n<p>Jos propsin tyyppi on väärä, esim. yritetään määritellä propsiksi <em>handleChange</em> merkkijono, seurauksena on varoitus:</p>\n<picture><img src=\"/static/cd199a5b2270dd60ddc9fb452ef9761d/14be6/7.png\" srcset=\"/static/cd199a5b2270dd60ddc9fb452ef9761d/4cce7/7.png 200w,\n/static/cd199a5b2270dd60ddc9fb452ef9761d/bae5f/7.png 400w,\n/static/cd199a5b2270dd60ddc9fb452ef9761d/14be6/7.png 800w,\n/static/cd199a5b2270dd60ddc9fb452ef9761d/1b35a/7.png 1200w,\n/static/cd199a5b2270dd60ddc9fb452ef9761d/9ee03/7.png 1600w,\n/static/cd199a5b2270dd60ddc9fb452ef9761d/536b3/7.png 1728w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Luokkaperustaisille komponenteille PropTypet on mahdollista määritellä myös <em>luokkamuuttujina</em>, seuraavalla syntaksilla:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> PropTypes <span class=\"token keyword\">from</span> <span class=\"token string\">'prop-types'</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Togglable</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">static</span> propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    buttonLabel<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">.</span>isRequired\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token comment\">// ...</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>Muuttujamäärittelyn edessä oleva <em>static</em> määrittelee nyt, että <em>propTypes</em>-kenttä on nimenomaan komponentin määrittelevällä luokalla <em>Togglable</em> eikä luokan instansseilla. Oleellisesti ottaen kyseessä on ainoastaan Javascriptin vielä standardoimattoman <a href=\"https://github.com/tc39/proposal-class-fields\">ominaisuuden</a> mahdollistava syntaktinen oikotie määritellä seuraava:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">Togglable<span class=\"token punctuation\">.</span>propTypes <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n  buttonLabel<span class=\"token punctuation\">:</span> PropTypes<span class=\"token punctuation\">.</span>string<span class=\"token punctuation\">.</span>isRequired<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>Surffatessasi internetissä saatat vielä nähdä ennen Reactin versiota 0.16 tehtyjä esimerkkejä, joissa PropTypejen käyttö ei edellytä erillistä kirjastoa. Versiosta 0.16 alkaen PropTypejä ei enää määritelty React-kirjastossa itsessään ja kirjaston <em>prop-types</em> käyttö on pakollista.</p>\n<h3>Tehtäviä</h3>\n<p>Tee nyt tehtävä <a href=\"/teht%C3%A4v%C3%A4t#proptypet\">5.11</a></p>\n<h3>ESlint</h3>\n<p>Konfiguroimme osassa 3 koodin tyylistä huolehtivan <a href=\"/osa3#lint\">ESlintin</a> backendiin. Otetaan nyt ESlint käyttöön myös frontendissa.</p>\n<p>Create-react-app on asentanut projektille eslintin valmiiksi, joten ei tarvita muuta kun sopiva konfiguraatio tiedoston <em>.eslintrc.js</em>.</p>\n<p>Tiedoston voi generoida komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">npx eslint --init</code></pre></div>\n<p>ja vastailemalla sopivasti kysymyksiin:</p>\n<picture><img src=\"/static/354495f1cf3ab7a581a690e6c465f45f/14be6/1a.png\" srcset=\"/static/354495f1cf3ab7a581a690e6c465f45f/4cce7/1a.png 200w,\n/static/354495f1cf3ab7a581a690e6c465f45f/bae5f/1a.png 400w,\n/static/354495f1cf3ab7a581a690e6c465f45f/14be6/1a.png 800w,\n/static/354495f1cf3ab7a581a690e6c465f45f/11572/1a.png 1116w\" sizes=\"(max-width: 800px) 100vw, 800px\"></picture>\n<p>Jotta pääsemme eroon testeissä olevista turhista huomautuksista asennetaan <a href=\"https://www.npmjs.com/package/eslint-plugin-jest\">eslint-jest-plugin</a></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> add --save-dev eslint-plugin-jest</code></pre></div>\n<p>ja otetaan se käyttöön manuaalin opastamalla tavalla.</p>\n<p>Jos vastailit initialisoinnissa kysymyksiin kuvan osoittamalla tavalla, asentuu projektiin <a href=\"https://github.com/yannickcr/eslint-plugin-react\">eslint-plugin-react</a>. Laajennetaan konfiguraatiota pluginin <a href=\"https://github.com/yannickcr/eslint-plugin-react#configuration\">manuaalin</a> ohjeen mukaan.</p>\n<p>Joudumme asentamaan myös <a href=\"https://github.com/babel/babel-eslint\">babel-eslint</a>-pluginin, jotta ESlint osaisi tulkita koodissa käyttämäämme <em>class property</em> -syntaksia. Pluginin asennus tapahtuu komennolla</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> <span class=\"token function\">install</span> babel-eslint --save-dev</code></pre></div>\n<p>ja se tulee muistaa ottaa käyttöön konfiguraatiossa.</p>\n<p>Seuraavassa lopullinen konfiguraatio, mihin on lisätty muutama muukin osassa 3 käyttöönotettu sääntö:</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">module.exports <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token string\">\"env\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"browser\"</span><span class=\"token keyword\">:</span> true,\n        <span class=\"token string\">\"es6\"</span><span class=\"token keyword\">:</span> true,\n        <span class=\"token string\">\"jest/globals\"</span><span class=\"token keyword\">:</span> <span class=\"token boolean\">true</span>\n    <span class=\"token punctuation\">}</span>,\n    <span class=\"token string\">\"extends\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"eslint:recommended\"</span>,\n        <span class=\"token string\">\"plugin:react/recommended\"</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"parser\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"babel-eslint\"</span>,\n    <span class=\"token string\">\"parserOptions\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"ecmaFeatures\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n            <span class=\"token string\">\"jsx\"</span><span class=\"token keyword\">:</span> <span class=\"token boolean\">true</span>\n        <span class=\"token punctuation\">}</span>,\n        <span class=\"token string\">\"ecmaVersion\"</span><span class=\"token keyword\">:</span> 2018,\n        <span class=\"token string\">\"sourceType\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"module\"</span>\n    <span class=\"token punctuation\">}</span>,\n    <span class=\"token string\">\"plugins\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n        <span class=\"token string\">\"react\"</span>, <span class=\"token string\">\"jest\"</span>\n    <span class=\"token punctuation\">]</span>,\n    <span class=\"token string\">\"rules\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">{</span>\n        <span class=\"token string\">\"indent\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>,\n            2\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"linebreak-style\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>,\n            <span class=\"token string\">\"unix\"</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"quotes\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>,\n            <span class=\"token string\">\"single\"</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"semi\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>,\n            <span class=\"token string\">\"never\"</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"eqeqeq\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"error\"</span>,\n        <span class=\"token string\">\"no-trailing-spaces\"</span><span class=\"token keyword\">:</span> <span class=\"token string\">\"error\"</span>,\n        <span class=\"token string\">\"object-curly-spacing\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>, <span class=\"token string\">\"always\"</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"arrow-spacing\"</span><span class=\"token keyword\">:</span> <span class=\"token punctuation\">[</span>\n            <span class=\"token string\">\"error\"</span>, <span class=\"token punctuation\">{</span> <span class=\"token string\">\"before\"</span><span class=\"token keyword\">:</span> true, <span class=\"token string\">\"after\"</span><span class=\"token keyword\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span>\n        <span class=\"token punctuation\">]</span>,\n        <span class=\"token string\">\"no-console\"</span><span class=\"token keyword\">:</span> 0,\n        <span class=\"token string\">\"react/prop-types\"</span><span class=\"token keyword\">:</span> 0\n    <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n</div>","frontmatter":{"mainImage":{"publicURL":"/static/part-5-1d38df3161654915a233d16795c6c490.svg"},"part":5,"letter":"b"}}},"pageContext":{"part":5,"letter":"b"}}